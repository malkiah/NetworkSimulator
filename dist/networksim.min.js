function createControlsWindow(){AnimationControls.controlsWindow=new UIWindow("controlswindow","Animation Controls",200,50,!1,1);var a=AnimationControls.controlsWindow.getPos();AnimationControls.controlsWindow.setPos(a.x,5);var b='<img src="img/64/minus.png" alt="Slow" title="Slow" onclick="AnimationControls.setSpeed(0.5);" style="width:32px;" />';b+='<img src="img/64/playpause.png" alt="Play/Pause" title="Play/Pause" onclick="AnimationControls.playPause();" style="width:32px;" />',b+='<img src="img/64/plus.png" alt="Fast" title="Fast" onclick="AnimationControls.setSpeed(2);" style="width:32px;" />',AnimationControls.controlsWindow.setControls(b),AnimationControls.controlsWindow.render()}function requestDHCPInfoCommand(a){network.getElement(a).getApp("DHCPClient").requestInfo()}function editDHCPServerInfo(a){createBkDiv(),createDHCPServerInfoDiv(a)}function createDHCPServerInfoDiv(a){var b=network.getElement(a),c=b.getApp("DHCPServer"),d=(document.createElement("div"),'<input type="button" id="upload" value="'+_("Save")+'" onclick="saveDHCPServerData('+a+');" />');d+='<input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelDHCPServerData();" />';var e=new UIWindow("divdhcpserverinfo","DHCP Server",400,200,!1,1);e.setContent(c.getAppController()),e.setControls(d),e.render()}function saveDHCPServerData(a){var b=network.getElement(a),c=document.getElementById("dhcpinitial").value,d=document.getElementById("dhcpend").value,e=document.getElementById("dhcpgw").value,f=document.getElementById("dhcpdns1").value,g=document.getElementById("dhcpdns2").value;b.getApp("DHCPServer").setData(c,d,e,f,g),removeBodyDiv("divbk"),uimanager.getWindow("divdhcpserverinfo").dispose()}function cancelDHCPServerData(){removeBodyDiv("divbk"),uimanager.getWindow("divdhcpserverinfo").dispose()}function createDNSLookup(a){createBkDiv(),createDNSLookupDiv(a)}function createDNSLookupDiv(a){var b=network.getElement(a),c=b.getApp("DNSClient"),d='<input type="button" id="upload" value="'+_("Lookup")+'" onclick="requestDNSLookup('+a+');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelDNSLookup();" />',e=new UIWindow("divdnslookup","DNS lookup",400,200,!1,1);e.setContent(c.getAppController()),e.setControls(d),e.render()}function cancelDNSLookup(){uimanager.getWindow("divdnslookup").dispose(),removeBodyDiv("divbk")}function requestDNSLookup(a){var b=network.getElement(a),c=document.getElementById("dnsclientdomain").value;b.getApp("DNSClient").DNSLookup(c),uimanager.getWindow("divdnslookup").dispose(),removeBodyDiv("divbk")}function setupDNSServerConfig(a){createBkDiv(),createDNSServerConfigDiv(a)}function createDNSServerConfigDiv(a){var b=network.getElement(a),c=b.getApp("DNSServer"),d=[_("Domain"),_("IP")],e=c.getAppControllerData(),f=new UITable(d,e,"dnstable"),g='<input type="button" id="upload" value="'+_("Save")+'" onclick="saveDNSServerConfig('+a+",'"+f.getId()+'\');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelDNSServerConfig(\''+f.getId()+"');\" />",h=new UIWindow("divdnsserverconfig","DNS Server",400,400,!1,1);h.setContent(c.getAppController()),h.setControls(g),h.render(),f.render()}function saveDNSServerConfig(a,b){var c=uitables[b].getData(),d=network.getElement(a),e=d.getApp("DNSServer");e.resetDNSTable();for(var f=0;f<c.length;f++)e.setEntry(c[f][0],c[f][1]);var g=document.getElementById("forwarder").value;e.setForwarder(g),uimanager.getWindow("divdnsserverconfig").dispose(),removeBodyDiv("divbk"),uitables[b].dispose()}function cancelDNSServerConfig(a){uimanager.getWindow("divdnsserverconfig").dispose(),removeBodyDiv("divbk"),uitables[a].dispose()}function createGatewaysDiv(a){var b=network.getElement(a),c=[_("Network"),_("Mask"),_("Gateway")],d=b.getConnectable().getGatewayManager().getControllerData(),e=new UITable(c,d,"gwtable"),f='<input type="button" id="upload" value="'+_("Save")+'" onclick="saveGWConfig('+a+",'"+e.getId()+'\');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelGWConfig(\''+e.getId()+"');\" />",g=new UIWindow("divgwconfig",_("Gateway Configuration"),700,400,!1,1);g.setContent(b.getConnectable().getGatewayManager().getController()),g.setControls(f),g.render(),e.render()}function editGateways(a){createBkDiv(),createGatewaysDiv(a)}function cancelGWConfig(a){uimanager.getWindow("divgwconfig").dispose(),removeBodyDiv("divbk"),uitables[a].dispose()}function saveGWConfig(a,b){var c=network.getElement(a);c.getConnectable().getGatewayManager().purgeGatewayInfo();for(var d=uitables[b].getData(),e=0;e<d.length;e++){var f=d[e][0];f=""===f?"0.0.0.0":f;var g=d[e][1];g=""===g?"0.0.0.0":g;var h=d[e][2];c.getConnectable().getGatewayManager().addGatewayInfo(f,g,h)}uimanager.getWindow("divgwconfig").dispose(),removeBodyDiv("divbk"),uitables[b].dispose()}function getDinamycPort(){return++lastuseddinamycport}function getNextID(){return++lastusedid}function viewWebBrowser(a){createBkDiv();var b=network.getElement(a),c=b.getApp("HTTPClient"),d='<input type="button" id="close" value="'+_("Close")+'" onclick="closeWebBrowser();" />',e=new UIWindow("divhttpclient","HTTP Client (Browser)",400,400,!1,1);e.setContent(c.getAppController()),e.setControls(d),e.render()}function closeWebBrowser(){removeBodyDiv("divbk"),uimanager.getWindow("divhttpclient").dispose()}function requestHTTPWebSite(a){var b=network.getElement(a),c=b.getApp("HTTPClient"),d=document.getElementById("httpclienturl").value;c.requestHTTPWebSite(d)}function editHTTPServerInfo(a){createBkDiv(),createHTTPServerInfoDiv1(a)}function createHTTPServerInfoDiv1(a){var b=network.getElement(a),c=b.getApp("HTTPServer"),d=[_("Domain")],e=c.getAppControllerData1(),f=new UITable(d,e,"httptable");f.setSecondary(!0,"editDomainHTTPServerInfo"),f.setParam("hostid",a);var g='<input type="button" id="upload" value="'+_("Save")+'" onclick="saveHTTPServerData1('+a+",'"+f.getId()+'\');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelHTTPServerData1(\''+f.getId()+"');\" />",h=new UIWindow("divhttpserverinfo","HTTP Server",400,400,!1,1);h.setContent(c.getAppController1()),h.setControls(g),h.render(),f.render()}function createHTTPServerInfoDiv1back(a,b){var c=network.getElement(a),d=c.getApp("HTTPServer"),e=uitables[b].getParam("primaryuitableid"),f=(_("Domain"),uitables[e].getData(),uitables[e]),g='<input type="button" id="upload" value="'+_("Save")+'" onclick="saveHTTPServerData1('+a+",'"+f.getId()+'\');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelHTTPServerData1(\''+f.getId()+"');\" />",h=new UIWindow("divhttpserverinfo","HTTP Server",400,400,!1,1);h.setContent(d.getAppController1()),h.setControls(g),h.render(),f.render()}function createHTTPServerInfoDiv2(a,b,c){var d=network.getElement(a),e=d.getApp("HTTPServer"),f=[_("File")],g=c,h=new UITable(f,g,"httpfiletable");h.setSecondary(!0,"editFileHTTPServerInfo"),h.setParam("hostid",a),h.setParam("primaryuitableid",b);var i='<input type="button" id="upload" value="'+_("Back")+'" onclick="backHTTPServerData2('+a+",'"+h.getId()+"');\" />",j=new UIWindow("divhttpfileserverinfo","HTTP Domain Files",400,400,!1,1);j.setContent(e.getAppController2()),j.setControls(i),j.render(),h.render()}function createHTTPServerInfoDiv3(a,b,c){var d=uitables[b].getData(),e=d[c][1],f=network.getElement(a),g=f.getApp("HTTPServer"),h='<input type="button" id="upload" value="'+_("Back")+'" onclick="backHTTPServerData3('+a+",'"+b+"',"+c+');" />',i=new UIWindow("divhttpcontentsserverinfo","HTTP Domain File Edition",400,200,!1,1);i.setContent(g.getAppController3(e)),i.setControls(h),i.render()}function backHTTPServerData3(a,b,c){var d=uitables[b].getData(),e=document.getElementById("httpcontents").value;d[c][1]=e,uimanager.getWindow("divhttpcontentsserverinfo").dispose(),createHTTPServerInfoDiv2(a,uitables[b].getParam("primaryuitableid"),d)}function editFileHTTPServerInfo(a,b){var c=uitables[a].getParam("hostid"),d=uitables[a].getData();1==d[b].length&&(d[b][1]=""),uimanager.getWindow("divhttpfileserverinfo").dispose(),createHTTPServerInfoDiv3(c,a,b)}function editDomainHTTPServerInfo(a,b){var c=uitables[a].getParam("hostid"),d=uitables[a].getData();1==d[b].length&&(d[b][1]=[]);var e=d[b][1];uimanager.getWindow("divhttpserverinfo").dispose(),createHTTPServerInfoDiv2(c,a,e)}function backHTTPServerData2(a,b){uimanager.getWindow("divhttpfileserverinfo").dispose(),createHTTPServerInfoDiv1back(a,b)}function saveHTTPServerData1(a,b){var c=uitables[b].getData(),d=network.getElement(a),e=d.getApp("HTTPServer");e.resetHTTPServerInfo();for(var f=0;f<c.length;f++){var g=c[f][0];if(e.addDomain(g),c[f].length>1)for(var h=0;h<c[f][1].length;h++){var i=c[f][1][h][0];1===c[f][1][h].length&&(c[f][1][h][1]="");var j=c[f][1][h][1];e.setFileContents(g,i,j)}}uimanager.getWindow("divhttpserverinfo").dispose(),removeBodyDiv("divbk"),uitables[b].dispose()}function cancelHTTPServerData1(a){uimanager.getWindow("divhttpserverinfo").dispose(),removeBodyDiv("divbk"),uitables[a].dispose()}function editNameGroup(a){createBkDiv(),createNameGroupDiv(a)}function createNameGroupDiv(a){var b=network.getElement(a),c="<p>";c+='<label for="nametxt">'+_("Name:")+"</label>",c+='<input type="text" id="nametxt" value="'+(null===b.getName()?"":b.getName())+'" /><br/>',c+='<label for="grouptxt">'+_("Group:")+"</label>",c+='<input type="text" id="grouptxt" value="'+(null===b.getGroup()?"":b.getGroup())+'" />',c+="</p>";var d='<p>  <input type="button" id="save" value="'+_("Save")+'" onclick="saveNameGroup('+a+');" />  <input type="button" id="cancel" value="'+_("Exit")+'" onclick="cancelNameGroup();" />  </p>',e=new UIWindow("divnamegroup",_("Edit name / group"),400,150,!1,1);e.setContent(c),e.setControls(d),e.render()}function cancelNameGroup(){uimanager.getWindow("divnamegroup").dispose(),removeBodyDiv("divbk")}function saveNameGroup(a){var b=network.getElement(a),c=document.getElementById("nametxt").value,d=document.getElementById("grouptxt").value;d=""===d?null:d,b.setName(c),b.setGroup(d),uimanager.getWindow("divnamegroup").dispose(),removeBodyDiv("divbk")}function networkDiagnostics(a){createBkDiv(),createDiagnosticsDiv(a)}function createDiagnosticsDiv(a){var b=network.getElement(a),c=(document.createElement("div"),"<p>");c+='<select id="ifacepos">';for(var d=0;d<b.getConnectable().getConnectorNumber();d++)c+='<option value="'+d+'">'+b.getConnectorDesc(d)+"</option>";c+="</select>",c+='<input type="text" id="diagnosticstxt" />',c+="</p>",c+="<p>",c+='<input type="button" id="ping" value="Ping" onclick="diagnosticsPing('+a+')" />',c+='<input type="button" id="traceroute" value="Trace Route" onclick="diagnosticsTraceroute('+a+')" />',c+="</p>",c+='<div style="width:100%;height:250px;text-align:left;font-size:0.8em;font-style:italic;overflow-y:scroll;" id="diagnosticsconsole" >',c+=b.getConnectable().getTrafficManager().getDiagnosticsInfo(),c+="</div>";var e='<p><input type="button" id="cancel" value="'+_("Exit")+'" onclick="cancelDiagnostics();" /></p>',f=new UIWindow("divdiagnostics","Network diagnostics",400,400,!1,1);f.setContent(c),f.setControls(e),f.render()}function diagnosticsPing(a){var b=network.getElement(a),c=document.getElementById("diagnosticstxt").value,d=document.getElementById("ifacepos").value;b.getConnectable().getTrafficManager().ping(c,d)}function diagnosticsTraceroute(a){var b=network.getElement(a),c=document.getElementById("diagnosticstxt").value,d=document.getElementById("ifacepos").value;b.getConnectable().getTrafficManager().traceroute(c,d)}function cancelDiagnostics(){removeBodyDiv("divbk"),uimanager.getWindow("divdiagnostics").dispose()}function editNATTable(a){createBkDiv(),createNATDiv(a)}function createNATDiv(a){var b=network.getElement(a),c=(document.createElement("div"),[_("Input interface"),_("WAN Port"),_("LAN Port"),_("IP")]),d=b.getConnectable().getTrafficManager().getNATData(),e=new UITable(c,d,"nattable"),f="";if("router"===b.getType()){var g=b.getConnectable().getPerformNAT()?"checked='checked'":"";f+="<p>",f+="<input type='checkbox' id='performNAT' "+g+" />",f+="<label for='performNAT'>"+_("Gateway mode (uses NAT).")+"</label>",f+="</p>"}f+='<table id="nattable" style="font-size:0.8em;width:100%;"></table>';var h='<p>  <input type="button" id="upload" value="'+_("Save")+'" onclick="saveNATConfig('+a+",'"+e.getId()+'\');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelNATConfig(\''+e.getId()+"');\" />  </p>",i=new UIWindow("divnatconfig","Edit NAT",700,400,!1,1);i.setContent(f),i.setControls(h),i.render(),e.render()}function cancelNATConfig(a){uimanager.getWindow("divnatconfig").dispose(),removeBodyDiv("divbk"),uitables[a].dispose()}function saveNATConfig(a,b){var c=network.getElement(a);c.getConnectable().getTrafficManager().removeFixedNATData();for(var d=uitables[b].getData(),e=0;e<d.length;e++)c.getConnectable().getTrafficManager().addNATEntry(d[e][2],d[e][1],d[e][3],d[e][0],!0);var f=document.getElementById("performNAT");null!==f&&c.getConnectable().setPerformNAT(f.checked),uimanager.getWindow("divnatconfig").dispose(),removeBodyDiv("divbk"),uitables[b].dispose()}function editIpInfo(a,b){createBkDiv(),createIpDiv(a,b)}function createIpDiv(a,b){var c=network.getElement(a),d=c.getConnectable(),e=d.getIPInfo(b),f=document.createElement("div"),g=window.innerWidth/2-200,h=window.innerHeight/2-75,i=null!==e.getIPv4()?e.getIPv4():"",j=null!==e.getNetmask()?e.getNetmask():"255.255.255.0",k=null!==e.getDNS1()?e.getDNS1():"",l=null!==e.getDNS2()?e.getDNS2():"";f.setAttribute("style","position:absolute;top:"+h+"px;left:"+g+"px;z-index:110;background-color:white;width:400px;height:150px;border-radius:10px;border:1px solid;padding:10px;text-align:center;"),f.setAttribute("id","divipinfo");var m='<label for="ip">'+_("IP Address:")+"</label>";m+='<input id="ip" type="text" value="'+i+'" /><br/>',m+='<label for="nm">'+_("Network Mask:")+"</label>",m+='<input id="nm" type="text" value="'+j+'" /><br/>',m+='<label for="dns1">'+_("DNS 1:")+"</label>",m+='<input id="dns1" type="text" value="'+k+'" /><br/>',m+='<label for="dns2"'+_(">DNS 2:")+"</label>",m+='<input id="dns2" type="text" value="'+l+'" /><br/>';var n='<p>  <input type="button" id="upload" value="'+_("Save")+'" onclick="saveIpInfo('+a+","+b+');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelIpInfo();" />  </p>',o=new UIWindow("divipinfo","Edit IP Info",400,150,!1,1);o.setContent(m),o.setControls(n),o.render()}function saveIpInfo(a,b){var c=network.getElement(a),d=document.getElementById("ip").value,e=document.getElementById("nm").value,f=document.getElementById("dns1").value,g=document.getElementById("dns2").value;d=""===d?null:d,e=""===e?null:e,f=""===f?null:f,g=""===g?null:g,c.getConnectable().getIPInfo(b).setIPv4(d),c.getConnectable().getIPInfo(b).setNetmask(e),c.getConnectable().getIPInfo(b).setDNS1(f),c.getConnectable().getIPInfo(b).setDNS2(g),c.getConnectable().getIPInfo(b).setStatic(!0),uimanager.getWindow("divipinfo").dispose(),removeBodyDiv("divbk")}function cancelIpInfo(){uimanager.getWindow("divipinfo").dispose(),removeBodyDiv("divbk")}function isValidIPv4(a){var b=!1;if(null!==a){var c=a.split(".");if(4===c.length){var d=parseInt(c[0]),e=parseInt(c[1]),f=parseInt(c[2]),g=parseInt(c[3]);b=NaN!==d&&d>=0&&d<=255&&NaN!==e&&e>=0&&e<=255&&NaN!==f&&f>=0&&f<=255&&NaN!==g&&g>=0&&g<=255}}else b=!0;return b}function ipStringToInt(a){var b=null;if(null!==a){var c=a.split(".");b=c[0]<<24|c[1]<<16|c[2]<<8|c[3]}return b}function ipIntToString(a){if(result=null,null!==a){var b=255&a,c=a>>8&255,d=a>>16&255,e=a>>24&255;result=e+"."+d+"."+c+"."+b}return result}function selectLinkConnectors(a,b){createBkDiv(),createLinkConnectorsDiv(a,b)}function getElementConnectorsSelectables(a){for(var b="",c=0;c<a.getConnectable().getConnectorNumber();c++){var d=a.getConnectable().getConnector(c),e=d.isConnected()?" disabled='disabled' ":"";b+="<input type='radio' name='link_host_"+a.id+"' value='"+c+"' id='link_host_"+a.id+"_"+c+"' "+e+"/>",b+=a.getConnectorDesc(c),b+="<br/>"}return b}function createLinkConnectorsDiv(a,b){var c=network.getElement(a),d=network.getElement(b),e='<table style="font-size:0.8em;">';e+="<tr><th>"+c.getName()+"</th><th>"+d.getName()+"</th></tr>",e+="<tr>",e+="<td>",e+=getElementConnectorsSelectables(c),e+="</td>",e+="<td>",e+=getElementConnectorsSelectables(d),e+="</td>",e+="</tr>",e+="</table>";var f='<p>  <input type="button" id="upload" value="'+_("Save")+'" onclick="saveLinkConnectors('+a+","+b+');" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelLinkConnectors();" />  </p>',g=new UIWindow("divlinkconnectors","Create Link",400,400,!1,1);g.setContent(e),g.setControls(f),g.render()}function saveLinkConnectors(a,b){var c=document.querySelector('input[name="link_host_'+a+'"]:checked'),d=document.querySelector('input[name="link_host_'+b+'"]:checked');if(null!==c&&null!==d){var e=c.value,f=d.value;null!==e&&null!==f&&(network.createLink(a,e,b,f),uimanager.getWindow("divlinkconnectors").dispose(),removeBodyDiv("divbk"))}}function cancelLinkConnectors(){uimanager.getWindow("divlinkconnectors").dispose(),removeBodyDiv("divbk")}function getNextMessageId(){return++lastMessageId}function deleteSelected(){null!==network.getSelected()&&network.getSelected()instanceof Host?confirm("Do you really want to delete the selected element?")&&(network.deleteSelectedElement(),uimanager.selectedElementDeleted()):null!==network.getSelected()&&network.getSelected()instanceof Link&&confirm("Do you really want to delete the selected link?")&&(network.deleteSelectedLink(),uimanager.selectedLineDeleted())}function UIClickable(a,b,c){var a=a,b=b,c=c;this.isInCoords=function(a,b,c){alert("This function needs to be redefined - isInCoords")},this.performAction=function(){null!==a&&a(b)},this.getObject=function(){return c}}function sqr(a){return a*a}function dist2(a,b){return sqr(a.x-b.x)+sqr(a.y-b.y)}function distToSegmentSquared(a,b,c){var d=dist2(b,c);if(0==d)return dist2(a,b);var e=((a.x-b.x)*(c.x-b.x)+(a.y-b.y)*(c.y-b.y))/d;return e<0?dist2(a,b):e>1?dist2(a,c):dist2(a,{x:b.x+e*(c.x-b.x),y:b.y+e*(c.y-b.y)})}function distToSegment(a,b,c){return Math.sqrt(distToSegmentSquared(a,b,c))}function UILine(a,b,c,d,e,f,g,h){UIClickable.call(this,a,b,c),this.X1=d,this.Y1=e,this.X2=f,this.Y2=g,this.Z=h,this.setCoords=function(a,b,c,d,e){this.X1=a,this.Y1=b,this.X2=c,this.Y2=d,this.Z=e},this.isInCoords=function(a,b){return distToSegment({x:a,y:b},{x:this.X1,y:this.Y1},{x:this.X2,y:this.Y2})<LINE_SELECT_TOLERANCE}}function createLinkAction(){uimanager.createLinkAction()}function createBkDiv(){var a=document.createElement("div"),b=document.body.scrollWidth,c=document.body.scrollHeight;a.setAttribute("style","position:absolute;top:0;left:0;z-index:100;background-color:white;width:"+b+"px;height:"+c+"px;opacity:0.25;"),a.setAttribute("id","divbk"),document.body.appendChild(a)}function saveNetwork(){var a=document.getElementById("filename").value,b=document.createElement("a");b.setAttribute("href","data:text/plain;charset:utf-8,"+encodeURIComponent(network.save())),b.setAttribute("download",a),document.body.appendChild(b),b.click(),document.body.removeChild(b),cancelDownload()}function removeBodyDiv(a){var b=document.getElementById(a);document.body.removeChild(b)}function cancelUpload(){uimanager.getWindow("divupload").dispose(),removeBodyDiv("divbk")}function cancelDownload(){uimanager.getWindow("divdownload").dispose(),removeBodyDiv("divbk")}function confirmUpload(){var a=document.getElementById("uploaddata"),b=a.files[0],c=new FileReader;c.onload=function(a){var b=JSON.parse(a.target.result);network.load(b)},c.readAsText(b),uimanager.getWindow("divupload").dispose(),removeBodyDiv("divbk")}function createUploadDiv(){var a=(document.createElement("div"),'<p>  <input type="button" id="upload" value="'+_("Upload")+'" onclick="confirmUpload();" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelUpload();" />  </p>'),b=new UIWindow("divupload",_("Upload file"),400,150,!1,1);b.setContent('<p><input type="file" id="uploaddata" name="uploaddata" /></p>'),b.setControls(a),b.render()}function createDownloadDiv(){var a=(document.createElement("div"),'<p><label for="filename">'+_("File name:")+'</label><input type="text" id="filename" name="filename" value="network.json" /></p>'),b='<p>  <input type="button" id="upload" value="'+_("Download")+'" onclick="saveNetwork();" />  <input type="button" id="cancel" value="'+_("Cancel")+'" onclick="cancelDownload();" />  </p>',c=new UIWindow("divdownload",_("Download file"),400,150,!1,1);c.setContent(a),c.setControls(b),c.render()}function uploadClick(){createBkDiv(),createUploadDiv()}function downloadClick(){createBkDiv(),createDownloadDiv()}function UIRectangle(a,b,c,d,e,f,g,h,i){UIClickable.call(this,a,b,c),this.X=d,this.Y=e,this.W=f,this.H=g,this.Z=h;var i=i;this.setCoords=function(a,b,c,d,e){this.X=a,this.Y=b,this.W=c,this.H=d,this.Z=e},this.isInCoords=function(a,b){return i&&(a-=document.body.scrollLeft,b-=document.body.scrollTop),this.X<=a&&a<=this.X+this.W&&this.Y<b&&b<this.Y+this.H}}function getNextTableID(){return++lasttableid}function deleteUITableRow(a,b){uitables[a].deleteRow(b)}function addUITableRow(a){uitables[a].addRow()}function createLocaleDiv(){createBkDiv();var a=new UIWindow("localediv","Select language",300,150,!1,1),b=uitranslation.getControls(),c='<input type="button" value="'+_("Accept")+'" onclick="localeSelected();" />';c+='<input type="button" value="'+_("Cancel")+'" onclick="localeCancelled();" />',a.setContent(b),a.setControls(c),a.render()}function localeSelected(){var a=document.getElementById("localeselector").value;uitranslation.selectLocale(a),removeBodyDiv("divbk"),uimanager.getWindow("localediv").dispose()}function localeCancelled(){removeBodyDiv("divbk"),uimanager.getWindow("localediv").dispose()}function _(a){return uitranslation._(a)}function newElement(a){switch(a){case"host":network.createComputer(0,50);break;case"dns":network.createDNSServer(0,50);break;case"dhcp":network.createDHCPServer(0,50);break;case"web":network.createHTTPServer(0,50);break;case"switch":network.createSwitch(0,50,8);break;case"router":network.createRouter(0,50)}}function simulator(a){images=a;var b=document.getElementById("simcontainer"),c=document.getElementById("simcanvas"),d=b.offsetWidth*window.devicePixelRatio,e=b.offsetHeight*window.devicePixelRatio;c.width=d,c.height=e;var f=c.getContext("2d",{antialias:!0});uimanager=new UIManager,network=new Network(images,f,d,e),network.init(),null!==NetworkSimulator.initialdata&&network.load(NetworkSimulator.initialdata),createControlsWindow()}var AnimationControls={MSG_ADVANCE_PRE:0,MSG_ADVANCE:2,controlsWindow:null,setSpeed:function(a){this.MSG_ADVANCE*=a,this.MSG_ADVANCE>16?this.MSG_ADVANCE=16:this.MSG_ADVANCE<.125&&(this.MSG_ADVANCE=.125)},playPause:function(){var a=this.MSG_ADVANCE;this.MSG_ADVANCE=this.MSG_ADVANCE_PRE,this.MSG_ADVANCE_PRE=a}},Connectable=function(a,b,c,d,e){function f(){for(var a="0123456789ABCDEF",b="",c=0;c<12;c++)b+=a.charAt(Math.floor(Math.random()*a.length)),c%2==1&&11!==c&&(b+=":");j.push(b)}function g(){k.push(new IPInfo)}function h(){l=new TrafficManager(p,d,e),o=new GatewayManager(p),b===MACMODE_SHARED&&f(),c===IPMODE_SHARED&&g()}this.id=getNextID();var i=[],j=[],k=[],b=b,c=c,l=null,m=[],n=[],e=e,o=null,p=this,q=a;this.save=function(){var a={};a.version=1,a.id=this.id,a.connectors=[],a.macaddresses=[],a.ipinfos=[],a.macmode=b,a.ipmode=c,a.trafficManager=l.save(),a.gateways=o.save(),a.performNAT=e;for(var d=0;d<i.length;d++)a.connectors.push(i[d].save());a.macaddresses=j;for(var d=0;d<k.length;d++)a.ipinfos.push(k[d].save());return a},this.load=function(a){this.id=a.id;for(var d=0;d<a.connectors.length;d++)i[d].load(a.connectors[d]);j=a.macaddresses;for(var d=0;d<a.ipinfos.length;d++)k[d].load(a.ipinfos[d]);b=a.macmode,c=a.ipmode,void 0!==a.performNAT&&this.setPerformNAT(a.performNAT),l.load(a.trafficManager),o.load(a.gateways?a.gateways:null)},this.updateAddressing=function(a,b){n[a]=b},this.isInMyNetworks=function(a){for(var b=!1,c=0;!1===b&&c<i.length;){var d=this.getIPInfo(c);null!=d.getIPv4()&&(b=d.sameNetwork(a),c++)}return b},this.getDstMAC=function(a){return"255.255.255.255"==a?"FF:FF:FF:FF:FF:FF":this.isInMyNetworks(a)?this.findMACforIP(a,null):this.findMACforIP(o.getGatewayForIP(a,null))},this.findMACforIP=function(a,b){var c=null;if(null!==a)for(var d=0;null===c&&d<i.length;){if(i[d]!==b){var e=i[d].getConnectedConnector();if(null!==e){var f=e.getIPInfo();(null===f||f.sameNetwork(a))&&null!==(c=e.whoHas(a))&&(m[a]=c,n[c]=d)}}d++}return c},this.getTrafficManager=function(){return l},this.getGatewayManager=function(){return o},this.addConnector=function(a){i.push(a),b===MACMODE_UNIQUE&&f(),c===IPMODE_UNIQUE&&g()},this.removeConnector=function(a){i.slice(a,1)},this.getConnector=function(a){return i[a]},this.getConnectorNumber=function(){return i.length},this.getOwner=function(){return q},this.getMAC=function(a){var c=null;return a<j.length&&(b===MACMODE_SHARED&&(a=0),c=j[a]),c},this.getIPInfo=function(a){var b=null;return a<k.length&&(c===IPMODE_SHARED&&(a=0),b=k[a]),b},this.getFirstFreeConnector=function(){for(var a=!1,b=0;!1===a&&b<i.length;)i[b].isConnected()?b++:a=i[b];return a},this.compatibleIP=function(a,b){var c=b&&this.compatibleBroadcastIP(a);if(!c)for(var d=0;!c&&d<k.length;)c=k[d].getIPv4()===a,d++;return c},this.compatibleBroadcastIP=function(a){return"255.255.255.255"===a},this.compatibleMAC=function(a,b){var c=b&&this.compatibleBroadcastMAC(a);if(!c)for(var d=0;!c&&d<j.length;)c=j[d]===a,d++;return c},this.compatibleBroadcastMAC=function(a){return"FF:FF:FF:FF:FF:FF"===a},this.getConnectorPos=function(a){return i.indexOf(a)},this.getIpMode=function(){return c},this.getSenderConnectorForMAC=function(a){var b=null;return a in n&&(b=i[n[a]]),b},this.findConnector=function(a){for(var b=null,c=0;null===b&&c<i.length;)i[c].id===a&&(b=i[c]),c++;return b},this.getPerformNAT=function(){return e},this.setPerformNAT=function(a){e=a,l.setPerformNAT(a)},h()},Connector=function(a){function b(){a.addConnector(d)}this.id=getNextID();var a=a,c=null,d=this;this.save=function(){var a={};return a.version=1,a.id=this.id,a},this.load=function(a){this.id=a.id},this.setLink=function(a){c=a},this.getLink=function(){return c},this.send=function(a){null!=c&&a.canSend()&&c.addMessage(d,a)},this.receive=function(b){a.getTrafficManager().proccess(this,b)},this.getConnectable=function(){return a},this.isConnected=function(){return null!==c},this.getConnectedConnector=function(){var a=null;return this.isConnected()&&(a=c.getConnector1()!==this?c.getConnector1():c.getConnector2()),a},this.getDescription=function(){var b="",c=a.getConnectorPos(this);"router"===a.getOwner().getType()&&(b+=c===ROUTER_LAN?"LAN":"WAN",b+=": ");var d=a.getIPInfo(c);return null!==d&&null!==d.getIPv4()&&(b+=d.getIPv4()),b},this.whoHas=function(b){var c=a.getConnectorPos(this),d=a.getIPInfo(c);return null!==d&&d.getIPv4()===b?a.getMAC(c):a.findMACforIP(b,this)},this.getIPInfo=function(){var b=null;switch(a.getIpMode()){case IPMODE_NOIP:b=null;break;case IPMODE_UNIQUE:var c=a.getConnectorPos(this);b=a.getIPInfo(c);break;case IPMODE_SHARED:b=a.getIPInfo(0)}return b},b()},DHCPClient=function(a){var b=null,a=a;this.save=function(){var b={};return b.version=1,b.id=this.getId(),b.ifacepos=a,b},this.load=function(a){},this.getId=function(){return"DHCPClient"},this.requestInfo=function(){var c={};c.type="request",c.description="DHCP: request";var d=new Message("tcp",b.getConnectable().getIPInfo(a).getIPv4(),"255.255.255.255",b.getConnectable().getMAC(a),"FF:FF:FF:FF:FF:FF",getDinamycPort(),67,c,images[IMAGE_ENVELOPEDHCP]);b.getConnectable().getTrafficManager().registerApplication(this,d.getOrigPort(),!1),b.getConnectable().getConnector(a).send(d)},this.receiveMessage=function(c){b.getConnectable().getIPInfo(a).setIPv4(c.getData().ipv4),b.getConnectable().getIPInfo(a).setDNS1(c.getData().dns1),b.getConnectable().getIPInfo(a).setDNS2(c.getData().dns2),b.getConnectable().getGatewayManager().addGatewayInfo("0.0.0.0","0.0.0.0",c.getData().gateway),b.getConnectable().getIPInfo(a).setNetmask(c.getData().netmask),b.getConnectable().getIPInfo(a).setStatic(!1)},this.setOwner=function(a){b=a},this.getIfacepos=function(){return a},this.getMenuEntries=function(){var a=[];return a[0]={},a[0].img="img/64/envelope-DHCP.png",a[0].text="Request DHCP info",a[0].js="requestDHCPInfoCommand("+b.id+");",a}},DHCPServer=function(a){function b(b){for(var c=e,f=!1;!f;)c in j?c++:f=!0;var g=d.getConnectable().getIPInfo(a).getIPv4().split("."),h=g[0]+"."+g[1]+"."+g[2]+".",i={};return i.mac=b,i.ipv4=h+c,j[c]=i,k[b]=i,c}function c(a){var b=null;return a in k&&(b=j.indexOf(k[a])),b}var d=null,a=a,e=100,f=200,g=null,h=null,i=null,j=[],k=[];this.save=function(){var b={};return b.version=1,b.id=this.getId(),b.ifacepos=a,b.initial=e,b.end=f,b.gateway=g,b.dns1=h,b.dns2=i,b},this.load=function(a){e=a.initial,f=a.end,g=a.gateway,h=a.dns1,i=a.dns2},this.getId=function(){return"DHCPServer"},this.setData=function(a,b,c,d,j){e=a,f=b,g=c,h=d,i=j},this.receiveMessage=function(e){if("request"===e.getData().type&&null!==d.getConnectable().getIPInfo(a).getIPv4()){var f=c(e.getOriginMAC());null===f&&(f=b(e.getOriginMAC()));var k={};k.ipv4=j[f].ipv4,k.dns1=h,k.dns2=i,k.gateway=g,k.netmask=d.getConnectable().getIPInfo(a).getNetmask(),k.description="DHCP: offer";var l=new Message("tcp",d.getConnectable().getIPInfo(a).getIPv4(),j[f].ipv4,d.getConnectable().getMAC(a),e.getOriginMAC(),67,e.getOrigPort(),k,images[IMAGE_ENVELOPEDHCP]);d.getConnectable().getConnector(a).send(l)}},this.setOwner=function(a){d=a},this.getIfacepos=function(){return a},this.getAppController=function(){network.getPosForElement(d);return result="<label for='dhcpinitial'>"+_("Initial:")+"</label>     <input type='text' id='dhcpinitial' value='"+e+"' /><br/>     <label for='dhcpend'>"+_("Final:")+"</label>     <input type='text' id='dhcpend' value='"+f+"' /><br/>     <label for='dhcpgw'>"+_("Gateway:")+"</label>     <input type='text' id='dhcpgw' value='"+(null===g?"":g)+"' /><br/>     <label for='dhcpdns1'>"+_("DNS 1:")+"</label>     <input type='text' id='dhcpdns1' value='"+(null===h?"":h)+"' /><br/>     <label for='dhcpdns2'>"+_("DNS 2:")+"</label>     <input type='text' id='dhcpdns2' value='"+(null===i?"":i)+"' /><br/>     ",result},this.getMenuEntries=function(){var a=[];return a[0]={},a[0].img="img/64/envelope-DHCP.png",a[0].text="Edit DHCP server info",a[0].js="editDHCPServerInfo("+d.id+");",a}},DNSClient=function(a){var b=null,a=a,c=[];this.save=function(){var b={};return b.version=1,b.id=this.getId(),b.ifacepos=a,b},this.load=function(a){},this.getId=function(){return"DNSClient"},this.DNSLookup=function(c){if(null!==b.getConnectable().getIPInfo(a).getIPv4()){var d=b.getConnectable().getDstMAC(b.getConnectable().getIPInfo(a).getDNS1());if(null!==d){var e={};e.domain=c,e.type="lookup",e.description="Lookup: "+c;var f=new Message("tcp",b.getConnectable().getIPInfo(a).getIPv4(),b.getConnectable().getIPInfo(a).getDNS1(),b.getConnectable().getMAC(a),d,getDinamycPort(),53,e,images[IMAGE_ENVELOPEDNS]);b.getConnectable().getTrafficManager().registerApplication(this,f.getOrigPort(),!1),b.getConnectable().getConnector(a).send(f)}}},this.receiveMessage=function(a){null!==a.getData().ip&&(c[a.getData().domain]=a.getData().ip)},this.setOwner=function(a){b=a},this.getIfacepos=function(){return a},this.getIp=function(a){var b=null;return a in c&&(b=c[a]),b},this.getAppController=function(){network.getPosForElement(b);return"<p>         <label for='dnsclientdomain' >"+_("Domain:")+"</label>         <input type='text' id='dnsclientdomain' />         </p>"},this.getMenuEntries=function(){var a=[];return a[0]={},a[0].img="img/64/envelope-DNS.png",a[0].text="DNS lookup",a[0].js="createDNSLookup("+b.id+");",a}},DNSServer=function(a){function b(b){var c=f.getConnectable().getDstMAC(h)
;if(null!==c){var d={};d.domain=b.getData().domain,d.type="lookup_forward",d.description="Lookup Fwd: "+b.getData().domain,d.originId=b.getId();var e=new Message("tcp",f.getConnectable().getIPInfo(a).getIPv4(),h,f.getConnectable().getMAC(a),c,getDinamycPort(),53,d,images[IMAGE_ENVELOPEDNS]);i[e.getId()]={},i[e.getId()].domain=b.getData().domain,i[e.getId()].ip=b.getOriginIP(),i[e.getId()].port=b.getOrigPort(),i[e.getId()].originId=b.getId(),f.getConnectable().getTrafficManager().registerApplication(j,e.getOrigPort(),!1),f.getConnectable().getConnector(a).send(e)}}function c(c){var d=!1,e={};if(e.domain=c.getData().domain,e.type="response",e.domain in g?(e.ip=g[e.domain],e.description="Response: "+e.ip,d=!0):null!==h?b(c):(e.ip=null,e.description="Response: not found",d=!0),d){var i=new Message("tcp",f.getConnectable().getIPInfo(a).getIPv4(),c.getOriginIP(),f.getConnectable().getMAC(a),f.getConnectable().getDstMAC(c.getOriginIP()),53,c.getOrigPort(),e,images[IMAGE_ENVELOPEDNS]);f.getConnectable().getConnector(a).send(i)}}function d(c){var d=!1,e={};if(e.domain=c.getData().domain,e.type="response_forward",e.originId=c.getId(),e.domain in g?(e.ip=g[e.domain],e.description="Response Fwd: "+e.ip,d=!0):null!==h?b(c):(e.ip=null,e.description="Response Fwd: not found",d=!0),d){var i=new Message("tcp",f.getConnectable().getIPInfo(a).getIPv4(),c.getOriginIP(),f.getConnectable().getMAC(a),f.getConnectable().getDstMAC(c.getOriginIP()),53,c.getOrigPort(),e,images[IMAGE_ENVELOPEDNS]);f.getConnectable().getConnector(a).send(i)}}function e(b){if(b.getData().originId in i){var c={};c.domain=b.getData().domain,c.type="response_forward",c.originId=i[b.getData().originId].originId,null!==c.domain?(c.ip=b.getData().ip,c.description="Response Fwd: "+c.ip):(c.ip=null,c.description="Response Fwd: not found");var d=new Message("tcp",f.getConnectable().getIPInfo(a).getIPv4(),i[b.getData().originId].ip,f.getConnectable().getMAC(a),f.getConnectable().getDstMAC(i[b.getData().originId].ip),53,i[b.getData().originId].port,c,images[IMAGE_ENVELOPEDNS]);delete i[b.getData().originId],f.getConnectable().getConnector(a).send(d)}}var f=null,a=a,g=[],h=null,i=[],j=this;this.save=function(){var b={};b.version=1,b.id=this.getId(),b.ifacepos=a,b.dnstable=[],b.forwarder=h;for(var c in g){var d={};d.domain=c,d.ip=g[c],b.dnstable.push(d)}return b},this.load=function(a){a.forwarder&&(h=a.forwarder);for(var b=0;b<a.dnstable.length;b++)this.setEntry(a.dnstable[b].domain,a.dnstable[b].ip)},this.getId=function(){return"DNSServer"},this.getPort=function(){return port},this.resetDNSTable=function(){g=[]},this.setEntry=function(a,b){g[a]=b},this.deleteDNSEntry=function(a){a in g&&delete g[a]},this.receiveMessage=function(a){"lookup"===a.getData().type&&a.getData().domain?c(a):"lookup_forward"===a.getData().type&&a.getData().domain?d(a):"response_forward"===a.getData().type&&e(a)},this.setOwner=function(a){f=a},this.getIfacepos=function(){return a},this.getAppController=function(){network.getPosForElement(f);result="<table id='dnstable' style='font-size:0.8em;'></table>",result+="<p>",result+="<label for='forwarder'>"+_("Forwarder:")+"</label>";var a=null===h?"":h;return result+="<input type='text' id='forwarder' value='"+a+"' />",result+="</p>",result},this.getMenuEntries=function(){var a=[];return a[0]={},a[0].img="img/64/envelope-DNS.png",a[0].text="DNS server config",a[0].js="setupDNSServerConfig("+f.id+");",a},this.getAppControllerData=function(){var a=[];for(var b in g){var c=[];c.push(b),c.push(g[b]),a.push(c)}return a},this.setForwarder=function(a){h=a}},Drawable=function(a){function b(a){var b=8;a.font="8pt",a.fillStyle="black";for(var c=g.getStrInfo().split("\n"),h=0;h<c.length;h++)a.fillText(c[h],0,f.height+b),b+=8;DEBUG&&a.fillText("X: "+d+" - Y: "+e,0,f.height+b)}function c(){if(null!==f)for(var a=0;a<i.length;a++)i[a].drawableChanged()}this.id=getNextID();var d=0,e=0,f=null,g=a,h=new UIRectangle(null,null,this,0,0,0,0,0,!1);uimanager.addClickable(h);var i=[];this.save=function(){var a={};return a.version=1,a.id=this.id,a.X=d,a.Y=e,a},this.load=function(a){d=a.X,e=a.Y,this.id=a.id,c()},this.setPosition=function(a,b){d=a,e=b,null!==f&&h.setCoords(d,e,f.width,f.height,0),c()},this.getX=function(){return d},this.getY=function(){return e},this.getCenterX=function(){return d+f.width/2},this.getCenterY=function(){return e+f.height/2},this.setImage=function(a){f=a,null!==f&&h.setCoords(d,e,f.width,f.height,0),c()},this.draw=function(a){a.save(),a.translate(d,e),a.drawImage(f,0,0),b(a),a.restore()},this.getOwner=function(){return g},this.getRect=function(){var a={};return a.x=d,a.y=e,a.width=f.width,a.height=f.height,a},this.addObserver=function(a){i.push(a)},this.deleteObserver=function(a){var b=i.indexOf(a);i.splice(b,1)},this.dispose=function(){uimanager.removeClickable(h)}},GatewayManager=function(a){function b(){d.addGatewayInfo("0.0.0.0","0.0.0.0",null)}var c=[],d=this,e=null;this.addGatewayInfo=function(a,b,d){if(isValidIPv4(a)&&(null===d||isValidIPv4(d))){var f="0.0.0.0"===a,g={};g.dst=a,g.gw=d,f?(g.mask="0.0.0.0",e=g):(g.mask=b,c.push(g))}},this.save=function(){var a={};return a.defaultgw=e.gw,a.gateways=c,a},this.load=function(a){if(null!==a){this.addGatewayInfo("0.0.0.0","0.0.0.0",a.defaultgw);for(var b=0;b<a.gateways.length;b++)this.addGatewayInfo(a.gateways[b].dst,a.gateways[b].mask?a.gateways[b].mask:"255.255.255.0",a.gateways[b].gw)}},this.purgeGatewayInfo=function(){c=[],e.gw=null},this.getController=function(){return"<table style='width:100%;' id='gwtable'></table>"},this.getControllerData=function(){var a=[],b=[];null!==e.gw&&(b[0]=e.dst,b[1]=e.mask,b[2]=e.gw,a.push(b));for(var d=0;d<c.length;d++){var f=[];f[0]=c[d].dst,f[1]=c[d].mask,f[2]=c[d].gw,a.push(f)}return a},this.getGatewayForIP=function(a){var b=null;if(isValidIPv4(a)){for(var d=ipStringToInt(a),f=0;null===b&&f<c.length;){var g=ipStringToInt(c[f].dst),h=ipStringToInt(c[f].mask);(g&h)===(d&h)?b=c[f].gw:f++}null===b&&(b=e.gw)}return b},b()},MACMODE_SHARED=0,MACMODE_UNIQUE=1,IPMODE_SHARED=0,IPMODE_UNIQUE=1,IPMODE_NOIP=2,IMAGE_SWITCH=0,IMAGE_ROUTER=1,IMAGE_COMPUTER=2,IMAGE_SERVERWEB=3,IMAGE_SERVERDNS=4,IMAGE_SERVERDHCP=5,IMAGE_ENVELOPEDHCP=6,IMAGE_ENVELOPEDNS=7,IMAGE_ENVELOPEHTTP=8,IMAGE_ENVELOPEICMP=9,REFRESH_INTERVAL=1e3/60,LINE_SELECT_TOLERANCE=2,ROUTER_WAN=0,ROUTER_LAN=1,DEBUG=!1,network=null,images=null,uimanager=null,lastuseddinamycport=1024,lastusedid=0,NetworkSimulator={initialdata:null},HTTPClient=function(a){function b(){var a=document.getElementById("httpbrowsercontents");null!==a&&(a.innerHTML=h.getBrowserContents())}function c(c,f,g){if(null!==d.getConnectable().getIPInfo(a).getIPv4()){e=0,b();var i=d.getConnectable().getDstMAC(f);if(null!==i){var j={};j.domain=c,j.filename=g,j.ip=f,j.description="GET: "+g;var k=new Message("tcp",d.getConnectable().getIPInfo(a).getIPv4(),f,d.getConnectable().getMAC(a),i,getDinamycPort(),80,j,images[IMAGE_ENVELOPEHTTP]);d.getConnectable().getTrafficManager().registerApplication(h,k.getOrigPort(),!1),d.getConnectable().getConnector(a).send(k)}}}var d=null,a=a,e=null,f=null,g=null,h=this;this.save=function(){var b={};return b.version=1,b.id=this.getId(),b.ifacepos=a,b},this.load=function(a){},this.setOwner=function(a){d=a},this.getOwner=function(){return d},this.getIfacepos=function(){return a},this.getId=function(){return"HTTPClient"},this.resetHTTPServerInfo=function(){domains=[]},this.getMenuEntries=function(){var a=[];return a[0]={},a[0].img="img/64/envelope-HTTP.png",a[0].text="Web browser (HTTP client)",a[0].js="viewWebBrowser("+d.id+");",a},this.getBrowserContents=function(){var a="";switch(e){case 0:a=_("Loading...");break;case 404:a=_("404 - Not found");break;case 200:a=f;break;case 997:a=_("Malformed URL.\n\nUse only 'domain_or_ip/filename.html'.");break;case 998:a=_("DNS client not present.");break;case 999:a=_("Domain not in local DNS cache. Look up first.\n\nIf you already performed a lookup, the domain does not exist.")}return a=a.replace(/\n/g,"<br/>")},this.getAppController=function(){return result="<p>",result+="<input type='text' id='httpclienturl' style='width:80%;' value='"+(null!==g?g:"")+"' /> ",result+="<a href='#' onclick='requestHTTPWebSite(\""+d.id+"\");'>",result+="<img src='img/64/right-arrow.png' style='height:1em;' />",result+="</a>",result+="</p>",result+="<div id='httpbrowsercontents' style='font-style:italic;overflow:scroll;text-align:left;min-height:300px;'>",result+=this.getBrowserContents(),result+="</div>",result},this.requestHTTPWebSite=function(a){var a=document.getElementById("httpclienturl").value;g=a;var f=a.split("/",2);if(2===f.length){var h=null,i=f[0];if(isValidIPv4(i))h=f[0],c(h,h,f[1]);else{var j=d.getApp("DNSClient");if(null===j)e=998,b();else{var h=j.getIp(i);null===h?(e=999,b()):c(i,h,f[1])}}}else e=997,b()},this.receiveMessage=function(a){e=a.getData().code,f=a.getData().contents,b()}},HTTPServer=function(a){var b=null,a=a,c=[];this.save=function(){var b={};b.version=1,b.id=this.getId(),b.ifacepos=a,b.domains=[];for(domain in c){var d={};d.domain=domain,d.files=[];for(filename in c[domain]){var e={};e.filename=filename,e.contents=c[domain][filename],d.files.push(e)}b.domains.push(d)}return b},this.load=function(a){for(var b=0;b<a.domains.length;b++){var c=a.domains[b].domain;this.addDomain(c);for(var d=0;d<a.domains[b].files.length;d++){var e=a.domains[b].files[d].filename,f=a.domains[b].files[d].contents;this.setFileContents(c,e,f)}}},this.setOwner=function(a){b=a},this.getOwner=function(){return b},this.getIfacepos=function(){return a},this.getId=function(){return"HTTPServer"},this.addDomain=function(a){a in c||(c[a]=[])},this.deleteDomain=function(a){a in c&&delete c[a]},this.setFileContents=function(a,b,d){a in c&&(c[a][b]=d)},this.deleteFile=function(a,b){a in c&&file in c[a]&&delete c[a][b]},this.resetHTTPServerInfo=function(){c=[]},this.getMenuEntries=function(){var a=[];return a[0]={},a[0].img="img/64/envelope-HTTP.png",a[0].text="Edit HTTP server info",a[0].js="editHTTPServerInfo("+b.id+");",a},this.getAppController1=function(){return result="<table id='httptable' style='font-size:0.8em;'></table>",result},this.getAppController2=function(){return result="<table id='httpfiletable' style='font-size:0.8em;'></table>",result},this.getAppController3=function(a){return result="<textarea id='httpcontents' style='font-size:0.8em;width:100%;height:100px;'>",result+=a,result+="</textarea>",result},this.getAppControllerData1=function(){var a=[];for(var b in c){var d=[];d.push(b);var e=[];for(var f in c[b]){var g=[];g[0]=f,g[1]=c[b][f],e.push(g)}d.push(e),a.push(d)}return a},this.receiveMessage=function(d){var e=d.getData(),f=e.domain,g=e.filename,h=(e.ip,null),i=null;if(f in c)g in c[f]?(h=200,i=c[f][g]):(h=404,i="");else if(isValidIPv4(f)){var j=Object.keys(c);j.length>0&&g in c[j[0]]?(h=200,i=c[j[0]][g]):(h=404,i="")}else h=404,i="";var k={};k.code=h,k.contents=i,k.description=h+"-"+g;var l=new Message("tcp",b.getConnectable().getIPInfo(a).getIPv4(),d.getOriginIP(),b.getConnectable().getMAC(a),b.getConnectable().getDstMAC(d.getOriginIP()),80,d.getOrigPort(),k,images[IMAGE_ENVELOPEHTTP]);b.getConnectable().getConnector(a).send(l)}},Host=function(type,ports){function init(){switch(type){case"router":connectable=new Connectable(_self,MACMODE_UNIQUE,IPMODE_UNIQUE,!0,!0);break;case"switch":connectable=new Connectable(_self,MACMODE_SHARED,IPMODE_NOIP,!1,!1);break;default:connectable=new Connectable(_self,MACMODE_UNIQUE,IPMODE_UNIQUE,!0,!1)}for(var a=0;a<ports;a++){new Connector(connectable)}drawable=new Drawable(_self),drawable.addObserver(_self),menu=new UIMenu(name,0,0,!1),addStaticMenu(),uimanager.addMenu(menu)}function addStaticMenu(){if(menu.addEntry("img/64/delete.png","Delete element","deleteSelected();"),menu.addEntry("img/64/edit.png","Edit Name / Group","editNameGroup("+_self.id+");"),menu.addEntry("img/64/link.png","Create Link","createLinkAction();"),connectable.getIpMode()!==IPMODE_NOIP&&(menu.addEntry("img/64/inspect.png","Network diagnostics","networkDiagnostics("+_self.id+");"),menu.addEntry("img/64/edit.png","Edit Gateways","editGateways("+_self.id+");")),connectable.getIpMode()===IPMODE_UNIQUE)for(var a=0;a<connectable.getConnectorNumber();a++)menu.addEntry("img/64/edit.png","Edit IP Info - "+_self.getConnectorDesc(a),"editIpInfo("+_self.id+","+a+");");"router"===type&&menu.addEntry("img/64/edit.png","Edit NAT table","editNATTable("+_self.id+");")}function redoMenu(){menu.purge(),menu.setDescription(name),addStaticMenu();for(var a in apps)for(var b=apps[a],c=b.app.getMenuEntries(),d=0;d<c.length;d++)menu.addEntry(c[d].img,c[d].text,c[d].js)}this.id=getNextID();var type=type,connectable=null,drawable=null,_self=this,ports=ports,menu=null,name=type+" "+this.id,group=null,apps=[];this.save=function(){var a={};a.version=1,a.id=this.id,a.type=type,a.drawable=drawable.save(),a.connectable=connectable.save(),a.ports=ports,a.apps=[],a.name=name,a.group=group;for(var b in apps){var c={};c.app=apps[b].app.save(),c.port=apps[b].port,c.fixed=apps[b].fixed,c.type=b,c.ifacepos=apps[b].app.getIfacepos(),a.apps.push(c)}return a},this.load=function(data){switch(this.id=data.id,type=data.type,drawable.load(data.drawable),type){case"computer":drawable.setImage(network.getImages()[IMAGE_COMPUTER]);break;case"dhcpserver":drawable.setImage(network.getImages()[IMAGE_SERVERDHCP]);break;case"dnsserver":drawable.setImage(network.getImages()[IMAGE_SERVERDNS]);break;case"httpserver":drawable.setImage(network.getImages()[IMAGE_SERVERWEB]);break;case"router":drawable.setImage(network.getImages()[IMAGE_ROUTER]);break;case"switch":drawable.setImage(network.getImages()[IMAGE_SWITCH])}if(connectable.load(data.connectable),data.apps)for(var i=0;i<data.apps.length;i++){var app=eval("new "+data.apps[i].type+"("+data.apps[i].ifacepos+")");app.load(data.apps[i].app),this.addApp(app,data.apps[i].port,data.apps[i].fixed)}data.name&&this.setName(data.name),data.group&&(group=data.group),redoMenu()},this.setName=function(a){name=a,redoMenu()},this.setGroup=function(a){group=a},this.getName=function(){return name},this.getGroup=function(){return group},this.getConnectorDesc=function(a){var b=_("Interface ")+a;return"router"===type&&(b=a===ROUTER_WAN?"WAN":"LAN"),b},this.drawableChanged=function(){var a=drawable.getRect();menu.setPos(a.x+a.width,a.y)},this.addApp=function(a,b,c){apps[a.getId()]={},apps[a.getId()].app=a,apps[a.getId()].port=b,apps[a.getId()].fixed=c,a.setOwner(_self),c&&connectable.getTrafficManager().registerApplication(a,b,!0),redoMenu()},this.getAppNames=function(a){return Object.keys(apps)},this.getApp=function(a){var b=null;return a in apps&&(b=apps[a].app),b},this.getConnectable=function(){return connectable},this.getDrawable=function(){return drawable},this.getType=function(){return type},this.getStrInfo=function(){if(result=name,connectable.getIpMode()===IPMODE_UNIQUE)for(var a=0;a<connectable.getConnectorNumber();a++)result+="\n",result+=this.getConnectorDesc(a),result+=": ",result+=null===connectable.getIPInfo(a).getIPv4()?"-":connectable.getIPInfo(a).getIPv4();else connectable.getIpMode()===IPMODE_SHARED&&(result+="\n",result+=_("IP: "),result+=": ",result+=null===connectable.getIPInfo(0).getIPv4()?"-":connectable.getIPInfo(0).getIPv4());return result},this.getMenu=function(){return menu},this.dispose=function(){menu.getVisible()&&menu.hide(),uimanager.deleteMenu(menu),drawable.dispose()},init()},IPInfo=function(){var a=null,b=null,c=null,d=null,e=!1;this.save=function(){var f={};return f.IPv4=e?a:null,f.DNS1=e?b:null,f.DNS2=e?c:null,f.netmask=e?d:null,f.static=e,f},this.load=function(f){null!=f&&(a=f.IPv4,b=f.DNS1,c=f.DNS2,d=f.netmask,e=f.static)},this.sameNetwork=function(b){var c=!1;if(null!==a&&null!==d&&isValidIPv4(b)){c=(ipStringToInt(b)&d)===(a&d)}return c},this.setIPv4=function(b){isValidIPv4(b)&&(a=ipStringToInt(b))},this.setNetmask=function(a){isValidIPv4(a)&&(d=ipStringToInt(a))},this.setDNS1=function(a){isValidIPv4(a)&&(b=ipStringToInt(a))},this.setDNS2=function(a){isValidIPv4(a)&&(c=ipStringToInt(a))},this.setStatic=function(a){e=a},this.getIPv4=function(){return ipIntToString(a)},this.getDNS1=function(){return ipIntToString(b)},this.getDNS2=function(){return ipIntToString(c)},this.getNetmask=function(){return ipIntToString(d)},this.getStatic=function(){return e}},ImageLoader=function(a,b){function c(){if(e<a.length){var f=e;e++;var g=new Image;d.push(g),g.onload=function(){c()},g.src=a[f]}else b(d)}var a=a,d=[],e=0,b=b;this.getLoadedImages=function(){return this.loadedImages},this.load=function(){c()}},Link=function(a,b){function c(){i.setLink(l),j.setLink(l);var a=h();m=new UILine(null,null,l,a.x1,a.y1,a.x2,a.y2,0),uimanager.addClickable(m),i.getConnectable().getOwner().getDrawable().addObserver(l),j.getConnectable().getOwner().getDrawable().addObserver(l),n=new UIMenu("Link",0,0,!1),d(),uimanager.addMenu(n)}function d(){n.addEntry("img/64/delete.png","Delete element","deleteSelected();")}function e(a){var b=k[a].orig.getConnectable().getOwner().getDrawable().getCenterX(),c=k[a].orig.getConnectable().getOwner().getDrawable().getCenterY(),d=k[a].dst.getConnectable().getOwner().getDrawable().getCenterX(),e=k[a].dst.getConnectable().getOwner().getDrawable().getCenterY();return{x:b+(d-b)*k[a].pos/100,y:c+(e-c)*k[a].pos/100}}function f(a,b){var c=8;a.font="8pt",a.fillStyle="black";for(var d=b.getStrInfo().split("\n"),e=0;e<d.length;e++)a.fillText(d[e],0,b.getImage().height+c),c+=8}function g(a){for(var b=0;b<k.length;b++){var c=e(b);a.save(),a.translate(c.x,c.y),a.drawImage(k[b].message.getImage(),0,0),f(a,k[b].message),a.restore()}}function h(){return{x1:i.getConnectable().getOwner().getDrawable().getCenterX(),y1:i.getConnectable().getOwner().getDrawable().getCenterY(),x2:j.getConnectable().getOwner().getDrawable().getCenterX(),y2:j.getConnectable().getOwner().getDrawable().getCenterY()}}this.id=getNextID();var i=a,j=b,k=[],l=this,m=null,n=null;this.save=function(){var a={};return a.version=1,a.id=this.id,a.connector1=i.id,a.connector2=j.id,a},this.load=function(a){this.id=a.id},this.drawableChanged=function(){var a=h();m.setCoords(a.x1,a.y1,a.x2,a.y2,0)},this.dispose=function(){uimanager.removeClickable(m),i.getConnectable().getOwner().getDrawable().deleteObserver(l),j.getConnectable().getOwner().getDrawable().deleteObserver(l),n.getVisible()&&n.hide(),uimanager.deleteMenu(n)},this.getConnector1=function(){return i},this.getConnector2=function(){return j},this.delete=function(){i.setLink(null),j.setLink(null)},this.addMessage=function(a,b){var c={};c.pos=0,c.message=b,c.orig=a,c.dst=a===i?j:i,k.push(c)},this.draw=function(a,b){var c=h();a.lineWidth=2,a.strokeStyle=b?"blue":"red",a.beginPath(),a.moveTo(c.x1,c.y1),a.lineTo(c.x2,c.y2),a.stroke(),g(a)},this.update=function(){for(var a=[],b=0;b<k.length;b++)k[b].pos+=AnimationControls.MSG_ADVANCE,k[b].pos<100?a.push(k[b]):k[b].dst.receive(k[b].message);k=a},this.messageHasCoords=function(a,b,c){var d=e(a);return d.x<=b&&b<=d.x+k[a].message.getImage().width&&d.y<=c&&c<=d.y+k[a].message.getImage().height},this.getMessage=function(a){return k[a].message},this.getMessageCount=function(){return k.length},this.hasCoords=function(a,b){var c=h();return distToSegment({x:a,y:b},{x:c.x1,y:c.y1},{x:c.x2,y:c.y2})<LINE_SELECT_TOLERANCE},this.getCenter=function(){var a={},b=h();return a.x=(b.x1+b.x2)/2,a.y=(b.y1+b.y2)/2,a},this.getMenu=function(){return n},c()},lastMessageId=0,Message=function(a,b,c,d,e,f,g,h,i){var j=b,k=c,l=d,m=e,f=f,g=g,n=h,o=i,p=getNextMessageId(),a=a,q=32;this.decreaseTTL=function(){q--},this.canSend=function(){return 0!==q},this.getId=function(){return p},this.getImage=function(){return o},this.getOriginIP=function(){return j},this.setOriginIP=function(a){j=a},this.getOriginMAC=function(){return l},this.setOriginMAC=function(a){l=a},this.getDestinationIP=function(){return k},this.setDestinationIP=function(a){k=a},this.getDestinationMAC=function(){return m},this.setDestinationMAC=function(a){m=a},this.getOrigPort=function(){return f},this.setOrigPort=function(a){f=a},this.getDstPort=function(){return g},this.setDstPort=function(a){g=a},this.getData=function(){return n},this.getType=function(){return a},this.getStrInfo=function(){var a="Src: "+(null===this.getOriginIP()?"-":this.getOriginIP())+"\n";return a+="Dst: "+(null===this.getDestinationIP()?"-":this.getDestinationIP()),n.description&&(a+="\n",a+=n.description),a}},Network=function(a,b,d,e){function f(a,b,c,d){var e=-1;if(a.isConnected()){var g=a.getConnectedConnector().getConnectable();if(-1===d.indexOf(g))if(g.compatibleIP(b,!1)||g.compatibleMAC(c,!1))e=0;else{for(var h=1e5,i=0;i<g.getConnectorNumber();i++){d.push(g);var j=f(g.getConnector(i),b,c,d);j=-1===j?-1:j+1,-1!==j&&j<h&&(e=g.getConnector(i),h=j)}1e5!==h&&(e=h)}}return e}function g(a){a.getConnector1().setLink(null),a.getConnector2().setLink(null);var b=m.indexOf(a);m.splice(b,1),a.dispose()}function h(a){for(var b=u.getConnectable().getConnectorNumber(),c=0;c<b;c++){var d=u.getConnectable().getConnector(c);null!==d.getLink()&&g(d.getLink())}var e=l.indexOf(a);delete l[e]}function i(a){for(var b=[],c=Object.keys(l),d=0;d<c.length;d++){var e=l[c[d]];if(null!==e.getGroup()){if(!(e.getGroup()in b)){var f={};f.minx=1e6,f.miny=1e6,f.maxx=0,f.maxy=0,b[e.getGroup()]=f}var f=b[e.getGroup()],g=e.getDrawable().getRect();f.minx>g.x&&(f.minx=g.x),f.miny>g.y&&(f.miny=g.y),f.maxx<g.x+g.width&&(f.maxx=g.x+g.width),f.maxy<g.y+g.height&&(f.maxy=g.y+g.height)}}c=Object.keys(b);for(var d=0;d<c.length;d++){var f=b[c[d]];a.strokeStyle="rgba(255,255,255,0.5)",a.lineWidth=4,a.strokeRect(f.minx-10,f.miny-10,f.maxx-f.minx+20,f.maxy-f.miny+20),a.font="16pt",a.fillStyle="rgba(255,255,255,1.0)",a.fillText(c[d],f.minx,f.maxy+20)}}function j(){o.fillStyle="#DDDDDD",o.fillRect(0,0,q,t);for(var a=0;a<m.length;a++)m[a].update(),m[a].draw(o,u===m[a]);for(var b=Object.keys(l),a=0;a<b.length;a++)l[b[a]].getDrawable().draw(o);if(i(o),uimanager.render(o),DEBUG){o.fillStyle="#000000";var c=uimanager.getMousePos();o.fillText("Mouse coords - X: "+c.X+" - Y: "+c.Y,10,100)}}function k(a){m=[],l=[];for(var b=0;b<a.elements.length;b++){var c=null,d=1;a.elements[b].ports?d=a.elements[b].ports:"router"===a.elements[b].type&&(d=2),c=new Host(a.elements[b].type,d),c.load(a.elements[b]),l[c.id]=c}for(var b=0;b<a.links.length;b++){var e=p.findConnector(a.links[b].connector1),f=p.findConnector(a.links[b].connector2),g=new Link(e,f);g.load(a.links[b]),m.push(g)}lastusedid=a.lastusedid}var l=[],m=[],n=a,o=b,p=this,q=d,t=e,u=null;this.init=function(){setInterval(j,REFRESH_INTERVAL)},this.getImages=function(){return n},this.createComputer=function(a,b){c=new Host("computer",1),c.getDrawable().setPosition(a,b),c.getDrawable().setImage(n[IMAGE_COMPUTER]);var d=new DHCPClient(0);c.addApp(d,-1,!1);var e=new DNSClient(0);c.addApp(e,-1,!1);var f=new HTTPClient(0);return c.addApp(f,-1,!1),l[c.id]=c,c.id},this.createDHCPServer=function(a,b){c=new Host("dhcpserver",1),c.getDrawable().setPosition(a,b),c.getDrawable().setImage(n[IMAGE_SERVERDHCP]);var d=new DHCPServer(0);return c.addApp(d,67,!0),l[c.id]=c,c.id},this.createDNSServer=function(a,b){c=new Host("dnsserver",1),c.getDrawable().setPosition(a,b),c.getDrawable().setImage(n[IMAGE_SERVERDNS]);var d=new DNSServer(0);return c.addApp(d,53,!0),l[c.id]=c,c.id},this.createHTTPServer=function(a,b){c=new Host("httpserver",1),c.getDrawable().setPosition(a,b),c.getDrawable().setImage(n[IMAGE_SERVERWEB]);var d=new HTTPServer(0);return c.addApp(d,80,!0),l[c.id]=c,c.id},this.createSwitch=function(a,b,c){return s=new Host("switch",c),s.getDrawable().setPosition(a,b),s.getDrawable().setImage(n[IMAGE_SWITCH]),l[s.id]=s,s.id},this.createRouter=function(a,b){return r=new Host("router",2),r.getDrawable().setPosition(a,b),r.getDrawable().setImage(n[IMAGE_ROUTER]),l[r.id]=r,r.id},this.createLink=function(a,b,c,d){var e=l[a],f=l[c],g=e.getConnectable().getConnector(b),h=f.getConnectable().getConnector(d),i=!1;if(null!==g&&null!==h){var j=new Link(g,h);m.push(j),i=m.length}return i},this.getElement=function(a){return l[a]},this.getLink=function(a){var b=null;return a<m.length&&(b=m[a]),b},this.findNextConnectorInPath=function(a,b,c){for(var d=null,e=1e5,g=0;g<a.getConnectorNumber();g++){var h=[];h.push(a);var i=f(a.getConnector(g),b,c,h);i=-1===i?-1:i+1,-1!==i&&i<e&&(d=a.getConnector(g),e=i)}return d},this.getElementInCoords=function(a,b){for(var c=null,d=0,e=Object.keys(l);null===c&&d<e.length;)l[e[d]].getDrawable().hasCoords(a,b)?c=l[e[d]]:d++;return c},this.getMessageInCoords=function(a,b){for(var c=null,d=0;null===c&&d<m.length;){for(var e=m[d].getMessageCount(),f=0;null===c&&f<e;)m[d].messageHasCoords(f,a,b)?c=m[d].getMessage(f):f++;null===c&&d++}return c},this.getPosForElement=function(a){return l.indexOf(a)},this.getLinkInCoords=function(a,b){for(var c=null,d=0;null===c&&d<m.length;)m[d].hasCoords(a,b)?c=m[d]:d++;return c},this.setSelected=function(a){u=a},this.getSelected=function(){return u},this.deleteSelectedLink=function(){g(u),u=null},this.deleteSelectedElement=function(){h(u),u.dispose(),u=null},this.save=function(){var a={};a.version=1,a.lastusedid=lastusedid,a.elements=[],a.links=[];for(var b=Object.keys(l),c=0;c<b.length;c++)a.elements.push(l[b[c]].save());for(var c=0;c<m.length;c++)a.links.push(m[c].save());return JSON.stringify(a)},this.load=function(a){switch(uimanager.reset(),a.version){case 1:k(a)}},this.findConnector=function(a){for(var b=Object.keys(l),c=null,d=0;null===c&&d<b.length;)c=l[b[d]].getConnectable().findConnector(a),d++;return c}},TrafficManager=function(a,b,c){function d(d,e){var f=!1,j=!1;if(f=a.compatibleMAC(e.getDestinationMAC(),!0),j=!f||a.compatibleBroadcastMAC(e.getDestinationMAC())&&!b,f)if(e.decreaseTTL(),e.getDstPort()in g)g[e.getDstPort()].app.receiveMessage(e),g[e.getDstPort()].fixed||delete g[e.getDstPort()];else if(c&&!a.compatibleBroadcastMAC(e.getDestinationMAC()))if(e.getDstPort()in h&&h[e.getDstPort()].originIface==a.getConnectorPos(d)){var k=e.getDstPort();e.setDestinationIP(h[k].ip),e.setDstPort(h[k].port);var l=a.getDstMAC(e.getDestinationIP());if(null!==l){var m=a.getSenderConnectorForMAC(l);null!==m&&(e.setDestinationMAC(l),m.send(e))}h[k].fixed||delete h[k]}else{var n=getDinamycPort(),l=a.getDstMAC(e.getDestinationIP());if(null!==l){var m=a.getSenderConnectorForMAC(l);if(null!==m){var o=a.getConnectorPos(m);m!==d&&(i.addNATEntry(n,e.getOrigPort(),e.getOriginIP(),o,!1),e.setOriginIP(a.getIPInfo(o).getIPv4()),e.setOriginMAC(a.getMAC(o)),e.setOrigPort(n)),e.setDestinationMAC(l),m.send(e)}}}else if(!a.compatibleBroadcastMAC(e.getDestinationMAC())){var l=a.getDstMAC(e.getDestinationIP());if(null!==l){var m=a.getSenderConnectorForMAC(l);null!==m&&(e.setDestinationMAC(l),m.send(e))}}j&&i.sendMessage(d,e)}function e(b,d){var e=a.compatibleMAC(d.getDestinationMAC(),!1),g=null!==b.getIPInfo()&&d.getDestinationIP()===b.getIPInfo().getIPv4();switch(e&&d.decreaseTTL(),d.getData().command){case"ping":if(e&&g){var h=d.getOriginIP(),j=a.getConnectorPos(b),l=d.getId();i.pingResponse(h,j,l)}else if(e&&!g&&c){var m=a.getDstMAC(d.getDestinationIP());if(null!==m){var n=a.getSenderConnectorForMAC(m);if(null!==n){if(n!==b){var o=a.getConnectorPos(n),p={};p.ip=d.getOriginIP(),p.mac=d.getOriginMAC(),k[d.getId()]=p,d.setOriginIP(a.getIPInfo(o).getIPv4()),d.setOriginMAC(a.getMAC(o))}d.setDestinationMAC(m),n.send(d)}}}else if(!e||g||c)e||i.sendMessage(b,d);else{var m=a.getDstMAC(d.getDestinationIP());if(null!==m){var n=a.getSenderConnectorForMAC(m);null!==n&&(d.setDestinationMAC(m),n.send(d))}}break;case"traceroute":if(e&&g){var h=d.getOriginIP(),j=a.getConnectorPos(b),l=d.getId();i.tracerouteResponse(h,j,l,!0,d.getData().seq+1,d.getDestinationIP())}else if(e&&!g&&c){var m=a.getDstMAC(d.getDestinationIP());if(null!==m){var n=a.getSenderConnectorForMAC(m);if(null!==n){var h=d.getOriginIP(),j=a.getConnectorPos(b),l=d.getId(),q=d.getData().seq+1;if(i.tracerouteResponse(h,j,l,!1,q,d.getDestinationIP()),n!==b){var o=a.getConnectorPos(n),p={};p.ip=d.getOriginIP(),p.mac=d.getOriginMAC(),k[d.getId()]=p,d.setOriginIP(a.getIPInfo(o).getIPv4()),d.setOriginMAC(a.getMAC(o))}d.getData().seq=q,d.setDestinationMAC(m),n.send(d)}}}else if(!e||g||c)e||i.sendMessage(b,d);else{var m=a.getDstMAC(d.getDestinationIP());if(null!==m){var n=a.getSenderConnectorForMAC(m);if(null!==n){var h=d.getOriginIP(),j=a.getConnectorPos(b),l=d.getId(),q=d.getData().seq+1;i.tracerouteResponse(h,j,l,!1,q,d.getDestinationIP());var o=a.getConnectorPos(n);d.getData().seq=q,d.setOriginMAC(a.getMAC(o)),d.setDestinationMAC(m),n.send(d)}}}break;case"pingresponse":if(e&&d.getData().originMessageId in k)d.setDestinationIP(k[d.getData().originMessageId].ip),d.setDestinationMAC(k[d.getData().originMessageId].mac),i.sendMessage(b,d),delete k[d.getData().originMessageId];else if(!e||!g||d.getData().originMessageId in k)if(!e||g||d.getData().originMessageId in k)e||i.sendMessage(b,d);else{var m=a.getDstMAC(d.getDestinationIP());if(null!==m){var n=a.getSenderConnectorForMAC(m);null!==n&&(d.setDestinationMAC(m),n.send(d))}}else f(_("Ping response recieved from ")+d.getOriginIP());break;case"tracerouteresponse":if(e&&d.getData().originMessageId in k)d.setDestinationIP(k[d.getData().originMessageId].ip),d.setDestinationMAC(k[d.getData().originMessageId].mac),i.sendMessage(b,d),d.getData().final&&delete k[d.getData().originMessageId];else if(!e||!g||d.getData().originMessageId in k)if(!e||g||d.getData().originMessageId in k)e||i.sendMessage(b,d);else{var m=a.getDstMAC(d.getDestinationIP());if(null!==m){var n=a.getSenderConnectorForMAC(m);null!==n&&(d.setDestinationMAC(m),n.send(d))}}else f(d.getData().seq+_(" - Traceroute to ")+d.getData().dstIp+": "+d.getOriginIP())}}function f(a){j.push(a);var b=document.getElementById("diagnosticsconsole");null!==b&&(b.innerHTML=i.getDiagnosticsInfo())}this.id=getNextID();var a=a,g=[],b=b,c=c,h=[],i=this,j=[],k=[];this.save=function(){var a={};a.version=1,a.id=this.id,a.limitbroadcast=b,a.performNAT=c,a.NATtable=[];for(var d in h)h[d].fixed&&a.NATtable.push(h[d]);return a},this.load=function(a){this.id=a.id,b=a.limitbroadcast,c=a.performNAT;for(var d=0;d<a.NATtable.length;d++)this.addNATEntry(a.NATtable[d].newport,a.NATtable[d].port,a.NATtable[d].ip,a.NATtable[d].originIface?a.NATtable[d].originIface:ROUTER_WAN,a.NATtable[d].fixed)},this.registerApplication=function(a,b,c){var d={};d.app=a,d.port=b,d.fixed=c,g[b]=d},this.sendMessage=function(c,d){if(!b&&a.compatibleBroadcastMAC(d.getDestinationMAC()))for(var e=0;e<a.getConnectorNumber();e++){var f=a.getConnector(e);f!==c&&f.send(d)}else{var f=a.getSenderConnectorForMAC(d.getDestinationMAC());f!==c&&null!==f&&f.send(d)}},this.addNATEntry=function(a,b,c,d,e){h[a]={},h[a].ip=c,h[a].newport=a,h[a].port=b,h[a].originIface=d,h[a].fixed=e},this.getNATData=function(){var a=[];for(port in h)if(h[port].fixed){var b=[];b[0]=h[port].originIface,b[1]=h[port].port,b[2]=h[port].newport,b[3]=h[port].ip,a.push(b)}return a},this.removeFixedNATData=function(){for(port in h)h[port].fixed&&this.deleteNATEntry(port)},this.deleteNATEntry=function(a){a in h&&delete h[a]},this.proccess=function(b,c){switch(a.updateAddressing(c.getOriginMAC(),a.getConnectorPos(b)),c.getType()){case"tcp":d(b,c);break;case"icmp":e(b,c)}},this.getFixedNATtable=function(){var a=[];for(var b in h)h[b].fixed&&(a[b]={},a[b].port=h[b].port,a[b].ip=h[b].ip);return a},this.getDiagnosticsInfo=function(){for(var a="",b=j.length-1;b>=0;b--)a+=j[b]+(b===j.length?"":"<br/>");return a},this.ping=function(b,c){if(null!==a.getIPInfo(c).getIPv4()){var d=null;if(null===(d=isValidIPv4(b)?b:a.getOwner().getApp("DNSClient").getIp(b)))f("Unknown domain: "+b);else{var e=a.getDstMAC(d);if(null!==e){var g={};g.command="ping",g.description="PING: "+d;var h=new Message("icmp",a.getIPInfo(c).getIPv4(),d,a.getMAC(c),e,-1,-1,g,images[IMAGE_ENVELOPEICMP]);f(_("Sending ping to: ")+h.getDestinationIP()),a.getConnector(c).send(h)}else f(_("Network unreachable: ")+d)}}else f(_("Network not configured for interface: ")+c)},
this.traceroute=function(b,c){if(null!==a.getIPInfo(c).getIPv4()){var d=null;if(null===(d=isValidIPv4(b)?b:a.getOwner().getApp("DNSClient").getIp(b)))f("Unknown domain: "+b);else{var e=a.getDstMAC(d);if(null!==e){var g={};g.command="traceroute",g.description="Traceroute: "+d,g.seq=0;var h=new Message("icmp",a.getIPInfo(c).getIPv4(),d,a.getMAC(c),e,-1,-1,g,images[IMAGE_ENVELOPEICMP]);f(_("Sending traceroute to: ")+h.getDestinationIP()),a.getConnector(c).send(h)}else f(_("Network unreachable: ")+d)}}else f(_("Network not configured for interface: ")+c)},this.pingResponse=function(b,c,d){var e=null;if(null===(e=isValidIPv4(b)?b:a.getOwner().getApp("DNSClient").getIp(b)))f("Unknown domain: "+b);else{var g=a.getDstMAC(e);if(null!==g){var h={};h.command="pingresponse",h.description="PING Response",h.originMessageId=d;var i=new Message("icmp",a.getIPInfo(c).getIPv4(),e,a.getMAC(c),g,-1,-1,h,images[IMAGE_ENVELOPEICMP]);a.getConnector(c).send(i)}}},this.tracerouteResponse=function(b,c,d,e,g,h){var i=null;if(null===(i=isValidIPv4(b)?b:a.getOwner().getApp("DNSClient").getIp(b)))f("Unknown domain: "+b);else{var j=a.getDstMAC(i);if(null!==j){var k={};k.command="tracerouteresponse",k.originMessageId=d,k.final=e,k.seq=g,k.dstIp=h,k.description="Traceroute Response";var l=new Message("icmp",a.getIPInfo(c).getIPv4(),i,a.getMAC(c),j,-1,-1,k,images[IMAGE_ENVELOPEICMP]);a.getConnector(c).send(l)}}},this.setPerformNAT=function(a){c=a}};UILine.prototype=new UIClickable,UILine.prototype.constructor=UILine;var UIManager=function(){function a(a){K.getVisible()?K.hide():K.show()}function b(){var b=document.getElementById("simcanvas");b.addEventListener("mousedown",c,!1),b.addEventListener("mouseup",d,!1),b.addEventListener("mousemove",e,!1);var f=b.getBoundingClientRect();K=new UIMenu("Main menu",42+f.left,3,!0),K.addEntry("img/64/upload.png",_("Upload"),"uploadClick();"),K.addEntry("img/64/save.png",_("Save"),"downloadClick();"),K.addEntry("img/64/computer.png",_("Add Host"),'newElement("host");'),K.addEntry("img/64/server_dhcp.png",_("Add DHCP server"),'newElement("dhcp");'),K.addEntry("img/64/server_dns.png",_("Add DNS server"),'newElement("dns");'),K.addEntry("img/64/server_web.png",_("Add web server"),'newElement("web");'),K.addEntry("img/64/switch.png",_("Add switch"),'newElement("switch");'),K.addEntry("img/64/router2.png",_("Add router"),'newElement("router");'),K.addEntry("img/64/i18n.png",_("Select language"),"createLocaleDiv();"),L.addMenu(K);var g=new UIRectangle(a,null,K,5,5,35,50,10,!0);L.addClickable(g)}function c(a){var b=document.getElementById("simcanvas"),c=b.getBoundingClientRect();m((a.clientX-c.left)*(b.width/c.width),(a.clientY-c.top)*(b.height/c.height),z)}function d(a){var b=document.getElementById("simcanvas"),c=b.getBoundingClientRect();m((a.clientX-c.left)*(b.width/c.width),(a.clientY-c.top)*(b.height/c.height),A)}function e(a){var b=document.getElementById("simcanvas"),c=b.getBoundingClientRect(),d=(a.clientX-c.left)*(b.width/c.width),e=(a.clientY-c.top)*(b.height/c.height);P=d,Q=e,m(d,e,B)}function f(){for(var a in G)G[a].getVisible()&&G[a].hide()}function g(a,b,c){var d=a.getRect();M=b-d.x,N=c-d.y}function h(a){a.getVisible()?a.hide():a.show()}function i(a){network.setSelected(a),a.getDrawable().addObserver(L);var b=a.getDrawable().getRect();O=new UIRectangle(h,a.getMenu(),L,b.x+b.width-10,b.y,10,10,50),L.addClickable(O)}function j(a){network.setSelected(a);var b=a.getCenter();O=new UIRectangle(h,a.getMenu(),L,b.x-5,b.y-5,10,10,50),a.getMenu().setPos(b.x+5,b.y-5),L.addClickable(O)}function k(a){null!==a&&a.getMenu().getVisible()&&(a.getMenu().hide(),a.getDrawable().deleteObserver(L)),L.removeClickable(O),network.setSelected(null)}function l(a){network.setSelected(null)}function m(a,b,c){switch(J){case r:switch(c){case z:var d=n(a,b);null!==d&&(d.getObject()===K?(f(),d.performAction(),J=w):d.getObject()instanceof Drawable?(g(d.getObject(),a,b),f(),i(d.getObject().getOwner()),J=s):d.getObject()instanceof Link&&(f(),j(d.getObject()),J=u))}break;case w:switch(c){case z:var d=n(a,b);null!==d?d.getObject()===K?(d.performAction(),J=r):d.getObject()instanceof Drawable?(g(d.getObject(),a,b),K.hide(),i(d.getObject().getOwner()),J=s):d.getObject()instanceof Link&&(f(),j(d.getObject()),J=u):(K.hide(),J=r);break;case C:K.hide(),J=r}break;case s:switch(c){case A:J=t;break;case B:network.getSelected().getDrawable().setPosition(a-M,b-N)}break;case t:switch(c){case z:var d=n(a,b);null!==d?d.getObject()===K?(f(),d.performAction(),network.setSelected(null),J=w):d.getObject()instanceof Drawable?(f(),k(network.getSelected()),i(d.getObject().getOwner()),J=s):d.getObject()instanceof UIManager?(d.performAction(),J=x):d.getObject()instanceof Link&&(f(),j(d.getObject()),J=u):(network.setSelected(null),J=r)}break;case u:switch(c){case z:var d=n(a,b);null!==d?d.getObject()===K?(f(),d.performAction(),network.setSelected(null),J=w):d.getObject()instanceof Drawable?(f(),l(network.getSelected()),i(d.getObject().getOwner()),J=s):d.getObject()instanceof UIManager?(d.performAction(),J=y):d.getObject()instanceof Link&&(f(),j(d.getObject()),J=u):(network.setSelected(null),J=r)}break;case y:switch(c){case z:var d=n(a,b);null!==d?d.getObject()===K?(f(),d.performAction(),network.setSelected(null),J=w):d.getObject()instanceof Drawable?(f(),l(network.getSelected()),i(d.getObject().getOwner()),J=s):d.getObject()instanceof UIManager?(d.performAction(),J=u):d.getObject()instanceof Link&&(f(),j(d.getObject()),J=u):(f(),l(network.getSelected()),J=r);break;case E:f(),l(network.getSelected()),J=r}break;case x:switch(c){case z:var d=n(a,b);null!==d?d.getObject()===K?(f(),d.performAction(),network.setSelected(null),J=w):d.getObject()instanceof Drawable?(f(),k(network.getSelected()),i(d.getObject().getOwner()),J=s):d.getObject()instanceof UIManager?(d.performAction(),J=x):d.getObject()instanceof Link&&(f(),j(d.getObject()),J=u):(k(network.getSelected()),f(),J=r);break;case C:f(),J=t;break;case D:f(),k(network.getSelected()),J=r;break;case F:f(),J=v}break;case v:switch(c){case z:var d=n(a,b);null!==d?d.getObject()instanceof Drawable&&(f(),selectLinkConnectors(network.getSelected().id,d.getObject().getOwner().id),J=t):(f(),J=t)}}}function n(a,b){for(var c=null,d=0;d<H.length;d++)H[d].isInCoords(a,b)&&(null===c||H[d].Z>c.Z)&&(c=H[d]);return c}function o(a){a.fillStyle="rgba(255,255,255,0.5)",a.fillRect(5,document.body.scrollTop+5,35,50),a.strokeStyle="rgba(255,255,255,1.0)",a.lineWidth=4,a.strokeRect(5,document.body.scrollTop+5,35,50),a.lineWidth=5;for(var b=15;b<50;b+=10)a.strokeRect(12,document.body.scrollTop+b,21,0)}function p(a){if(J===s||J===t||J===x||J===v){var b=network.getSelected().getDrawable().getRect();a.strokeStyle="rgba(100,100,100,0.75)",a.lineWidth=5,a.strokeRect(b.x,b.y,b.width,b.height),a.fillStyle="rgba(255,255,255,0.75)",a.strokeStyle="rgba(255,255,255,0.75)",a.fillRect(O.X,O.Y,O.W,O.H),a.lineWidth=2,a.strokeRect(O.X,O.Y,O.W,O.H)}else if(J===u||J===y){var c=network.getSelected().getCenter();a.fillStyle="rgba(255,255,255,0.75)",a.strokeStyle="rgba(255,255,255,0.75)",a.fillRect(c.x-5,c.y-5,10,10),a.lineWidth=2,a.strokeRect(c.x-5,c.y-5,10,10)}}function q(a){if(J===v){var b=network.getSelected().getDrawable().getRect(),c=b.x+b.width/2,d=b.y+b.height/2;a.strokeStyle="rgba(128,255,128,1.0)",a.lineWidth=2,a.beginPath(),a.moveTo(c,d),a.lineTo(P,Q),a.stroke()}}var r=0,s=1,t=2,u=3,v=5,w=6,x=7,y=8,z=0,A=1,B=2,C=3,D=4,E=5,F=6,G=[],H=[],I=[],J=(document.getElementById("simcanvas"),r),K=null,L=this,M=0,N=0,O=null,P=0,Q=0;this.addWindow=function(a){I[a.getId()]=a},this.getWindow=function(a){return I[a]},this.removeWindow=function(a){delete I[a.getId()]},this.reset=function(){this.clickables=[];var b=new UIRectangle(a,null,K,5,5,35,50,10,!0);this.addClickable(b)},this.drawableChanged=function(){if(null!==network.getSelected()){var a=network.getSelected().getDrawable().getRect();O.X=a.x+a.width-10,O.Y=a.y}},this.menuOptionClicked=function(){m(-1,-1,C)},this.selectedElementDeleted=function(){m(-1,-1,D)},this.selectedLineDeleted=function(){m(-1,-1,E)},this.createLinkAction=function(){m(-1,-1,F)},this.addMenu=function(a){G[a.getId()]=a},this.deleteMenu=function(a){G[a.getId()].dispose(),delete G[a.getId()]},this.getMenu=function(a){return G[a]},this.addClickable=function(a){H.push(a)},this.removeClickable=function(a){var b=H.indexOf(a);H.splice(b,1)},this.render=function(a){p(a),q(a),o(a)},this.getMousePos=function(){return{X:P,Y:Q}},b()},UIMenu=function(a,b,c,d){function e(){uitranslation.addObserver(i)}var b=b,c=c,f=[],g="uimenu_"+getNextID(),a=a,h=!1,d=d,i=this;this.dispose=function(){uitranslation.deleteObserver(this)},this.localeChanged=function(){},this.getId=function(){return g},this.getVisible=function(){return h},this.addEntry=function(a,b,c){var d={};d.id="entry_"+getNextID(),d.img=a,d.text=b,d.js=c,f.push(d)},this.setPos=function(a,d){b=a,c=d},this.setDescription=function(b){a=b},this.purge=function(){f=[]},this.show=function(){var e=document.createElement("div");e.setAttribute("id",g),e.setAttribute("style","width:200px;background-color:#EEEEEE;border:3px solid white;position:"+(d?"fixed":"absolute")+";top:"+c+"px;left:"+b+"px;font-size:0.8em;padding:0px 10px 0px;");for(var i="<span style='font-weight:bold'>"+_(a)+"</span><hr/>",j=0;j<f.length;j++)i+="<a href='#' onclick='"+f[j].js+"uimanager.menuOptionClicked();'>",i+="<img src='"+f[j].img+"' style='max-height:32px;max-width:32px;' />",i+="<span id='"+f[j].id+"'>"+_(f[j].text)+"</span></a><br/>",j!==f.length-1&&(i+="<hr/>");e.innerHTML=i,document.body.appendChild(e),h=!0},this.hide=function(){var a=document.getElementById(g);document.body.removeChild(a),h=!1},e()};UIRectangle.prototype=new UIClickable,UIRectangle.prototype.constructor=UIRectangle;var lasttableid=0,uitables=[],UITable=function(a,b,c){var a=a,b=b,c=c,d="uitable_"+getNextTableID(),e=!1,f=null,g=[];uitables[d]=this,this.getId=function(){return d},this.setParam=function(a,b){g[a]=b},this.getParam=function(a){var b=null;return a in g&&(b=g[a]),b},this.setSecondary=function(a,b){e=a,f=b},this.render=function(){var g="";g+="<tr>";for(var h=0;h<a.length;h++)g+="<th>"+a[h]+"</th>";g+="<th>"+_("Controls")+"</th>",g+="</tr>";for(var h=0;h<b.length;h++){g+="<tr>";for(var i=0;i<a.length;i++){var j=c+"_"+h+"_"+i;g+="<td>",g+='<input type="text" id="'+j+'" value="'+b[h][i]+'" disabled="disabled" />',g+="</td>"}g+="<td>",g+='<img src="img/64/delete.png" title="'+_("Delete")+'" alt="'+_("Delete")+'" style="width:24px;" onclick="deleteUITableRow(\''+d+"',"+h+')" />',e&&(g+='<img src="img/64/edit.png" title="'+_("Edit")+'" alt="'+_("Edit")+'" style="width:24px;" onclick="'+f+"('"+d+"',"+h+')" />'),g+="</td>",g+="</tr>"}g+="<tr>";for(var i=0;i<a.length;i++){var j=c+"_new_"+i;g+="<td>",g+='<input type="text" id="'+j+'" />',g+="</td>"}g+='<td><img src="img/64/add.png" title="'+_("Add")+'" alt="'+_("Add")+'" style="width:24px;" onclick="addUITableRow(\''+d+"')\" /></td>",g+="</tr>",document.getElementById(c).innerHTML=g},this.deleteRow=function(a){b.splice(a,1),this.render()},this.dispose=function(){delete uitables[d]},this.getData=function(){return b},this.addRow=function(){for(var d=[],e=0;e<a.length;e++){var f=c+"_new_"+e,g=document.getElementById(f).value;d.push(g)}b.push(d),this.render()}},UITranslation=function(){function a(){for(var a=0;a<d.length;a++)d[a].localeChanged()}var b="en_GB",c=[],d=[];this.registerLocale=function(a){c[a.locale]=a},this.getLocales=function(){return Object.keys(c)},this.addObserver=function(a){d.push(a)},this.removeObserver=function(a){var b=d.indexOf(a);b>=0&&d.splice(b,1)},this.selectLocale=function(c){b=c,a()},this._=function(a){var d=a;return b in c&&a in c[b]&&(d=c[b][a]),d},this.getControls=function(){var a='<label for="localeselector">'+_("Language:")+' </label><select id="localeselector">';for(locale in c){var d=c[locale].locale===b?'selected="selected"':"";a+='<option value="'+c[locale].locale+'" '+d+">"+c[locale].name+"</option>"}return a+="</select>"}},uitranslation=new UITranslation,UIWindow=function(a,b,c,d,e,f){function g(a){var b=x.getBoundingClientRect(),c=a.clientX,d=a.clientY;b.left<=c&&c<=b.left+b.width&&b.top<=d&&d<=b.top+b.height&&j(c,d,p)}function h(a){j(-1,-1,q)}function i(a){j(a.clientX,a.clientY,r)}function j(a,b,c){switch(o){case m:switch(c){case q:o=n;break;case r:s=a-A+scrollX,t=b-B+scrollY,w.setAttribute("style",k())}break;case n:switch(c){case p:var d=x.getBoundingClientRect();A=a-d.left,B=b-d.top,o=m}}}function k(){return"position:absolute;top:"+t+"px;left:"+s+"px;z-index:110;background-color:white;width:"+c+"px;height:"+d+"px;border-radius:10px;border:1px solid;padding:10px;text-align:center;opacity:"+f+";"}function l(){w=document.createElement("div"),w.setAttribute("id",a),w.setAttribute("style",k()),x=document.createElement("div"),x.setAttribute("id",a+"_title"),x.setAttribute("style","width:100%;height:20px;background-color:blue;color:white;font-weight:bold;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;"),x.innerHTML=_(b),y=document.createElement("div"),y.setAttribute("id",u),y.setAttribute("style","width:100%; height:"+d-80+"px;"),z=document.createElement("div"),z.setAttribute("id",v),z.setAttribute("style","width:100%; height:40px;"),window.addEventListener("mousedown",g,!0),window.addEventListener("mouseup",h,!0),window.addEventListener("mousemove",i,!0),uimanager.addWindow(C),uitranslation.addObserver(C)}var m=0,n=1,o=n,p=0,q=1,r=2,b=b,c=c,d=d,s=window.innerWidth/2-c/2,t=window.innerHeight/2-d/2,f=f,a=a,u=u+"_contents",v=v+"_controls",w=null,x=null,y=null,z=null,A=0,B=0,C=this;this.render=function(){w.appendChild(x),w.appendChild(y),w.appendChild(z),document.body.appendChild(w)},this.setControls=function(a){z.innerHTML=a},this.setContent=function(a){y.innerHTML=a},this.dispose=function(){window.removeEventListener("mousedown",g),window.removeEventListener("mouseup",h),window.removeEventListener("mousemove",i),uimanager.removeWindow(this),removeBodyDiv(a),uitranslation.removeObserver(this)},this.getId=function(){return a},this.getPos=function(){return{x:s,y:t}},this.setPos=function(a,b){s=a,t=b,w.setAttribute("style",k())},this.localeChanged=function(){x.innerHTML=_(b)},l()},en_GB={name:"English (GB)",locale:"en_GB"};uitranslation.registerLocale(en_GB);var es_ES={name:"Espaol",locale:"es_ES","Animation Controls":"Controles de Animacin",Accept:"Aceptar",Cancel:"Cancelar","Language:":"Idioma:","Select language":"Selecciona idioma",Upload:"Cargar",Save:"Guardar","Add Host":"Aadir equipo","Add DHCP server":"Aadir servidor DHCP","Add DNS server":"Aadir servidor DNS","Add web server":"Aadir servidor web","Add switch":"Aadir switch","Add router":"Aadir router","Delete element":"Eliminar","Edit Name / Group":"Editar nombre/grupo","Create Link":"Crear enlace","Network diagnostics":"Diagnsticos de red","Edit Gateways":"Editar gateways","Edit IP Info - Interface 0":"Editar informacin IP - Interfaz 0","Edit IP Info - WAN":"Editar informacin IP - WAN","Edit IP Info - LAN":"Editar informacin IP - LAN","Edit NAT table":"Editar tabla NAT","Main menu":"Men principal","Upload file":"Cargar fichero","Request DHCP info":"Solicitar info. DHCP","DNS lookup":"Bsqueda DNS","Web browser (HTTP client)":"Navegador web (cliente HTTP)","Edit name / group":"Editar nombre / grupo",Save:"Guardar",Exit:"Salir","Group:":"Grupo:","Name:":"Nombre:","Interface ":"Interfaz ",Network:"Red",Mask:"Mscara",Gateway:"Gateway",Controls:"Controles","Gateway Configuration":"Configuracin de gateways","IP Address:":"Direccin IP:","Network Mask:":"Mscara de red:","DNS 1:":"DNS 1:","DNS 2:":"DNS 2:","Edit IP Info":"Editar Info IP:","Domain:":"Dominio:",Lookup:"Buscar",Domain:"Dominio",IP:"IP","DNS Server":"Servidor DNS","Forwarder:":"Forwarder:","DNS server config":"Configurar servidor DNS","DHCP Server":"Servidor DHCP","Initial:":"Inicial:","Final:":"Final:","Gateway:":"Gateway:",Close:"Cerrar","HTTP Client (Browser)":"Cliente HTTP (Navegador)","Loading...":"Cargando...","404 - Not found":"404 - No encontrado","Malformed URL.\n\nUse only 'domain_or_ip/filename.html'.":"URL incorrecta.\n\nUsa slo 'dominio_o_ip/fichero.html'.","DNS client not present.":"Falta cliente DNS.","Domain not in local DNS cache. Look up first.\n\nIf you already performed a lookup, the domain does not exist.":"El dominio no est en la cach local. Busca primero.\n\nSi ya has realizado la bsqueda, el dominio no existe..","Edit DHCP server info":"Editar informacin del servidor DHCP","HTTP Server":"Servidor HTTP",File:"Fichero",Back:"Atrs","HTTP Domain Files":"Ficheros del Dominio HTTP","HTTP Domain File Edition":"Edicin de Fichero del Dominio HTTP","Input interface":"Interfaz de entrada","WAN Port":"Puerto WAN","LAN Port":"Puerto LAN","IP: ":"IP: ","Gateway mode (uses NAT).":"Modo gateway (usa NAT).","Edit NAT":"Editar NAT","Edit HTTP server info":"Editar informacin del servidor HTTP",Delete:"Eliminar",Edit:"Editar",Add:"Aadir","Sending traceroute to: ":"Enviando traceroute a: ","Sending ping to: ":"Enviando ping a: ","Ping response recieved from ":"Respuesta a ping recibida de "," - Traceroute to ":" - Traceroute a ","Network unreachable: ":"Red inaccesible: ","Network not configured for interface: ":"Red no configurada para la interfaz: ","File name:":"Nombre del fichero:",Download:"Descargar","Download file":"Descargar fichero"};uitranslation.registerLocale(es_ES);var eu_ES={name:"Euskara",locale:"eu_ES","Animation Controls":"Animazio kontrolak",Accept:"Onartu",Cancel:"Ezeztatu","Language:":"Hizkuntza:","Select language":"Aukeratu hizkuntza",Upload:"Kargatu",Save:"Gorde","Add Host":"Gehitu ordenagailua","Add DHCP server":"Gehitu DHCP zerbitzaria","Add DNS server":"Gehitu DNS zerbitzaria","Add web server":"Gehitu web zerbitzaria","Add switch":"Gehitu switch","Add router":"Gehitu router","Delete element":"Ezabatu","Edit Name / Group":"Izena/taldea editatu","Create Link":"Sortu lotura","Network diagnostics":"Sare diagnostikoak","Edit Gateways":"Gateway-ak editatu","Edit IP Info - Interface 0":"IP informazioa editatu - Interfaze 0","Edit IP Info - WAN":"IP informazioa editatu - WAN","Edit IP Info - LAN":"IP informazioa editatu - LAN","Edit NAT table":"NAT taula editatu","Main menu":"Menu nagusia","Upload file":"Fitxategia kargatu","Request DHCP info":"DHCP info eskatu","DNS lookup":"DNS bilaketa","Web browser (HTTP client)":"Nabigatzaile (HTTP bezeroa)","Edit name / group":"Izena / taldea editatu",Save:"Gorde",Exit:"Irten","Group:":"Taldea:","Name:":"Izena:","Interface ":"Interfaze ",Network:"Sarea",Mask:"Maskara",Gateway:"Gateway",Controls:"Kontrolak","Gateway Configuration":"Gateway-ak konfiguratu","IP Address:":"IP Helbidea:","Network Mask:":"Sare-maskara:","DNS 1:":"DNS 1:","DNS 2:":"DNS 2:","Edit IP Info":"IP Info editatu","Domain:":"Domeinua:",Lookup:"Bilatu",Domain:"Domeinua",IP:"IP","DNS Server":"DNS Zerbitzaria","Forwarder:":"Forwarder:","DNS server config":"DNS zerbitzaria konfiguratu","DHCP Server":"DHCP Zerbitzaria","Initial:":"Lehena:","Final:":"Azkena:","Gateway:":"Gateway:",Close:"Itxi","HTTP Client (Browser)":"HTTP Bezeroa (Nabigatzailea)","Loading...":"Kargatzen...","404 - Not found":"404 - Ez da aurkitu","Malformed URL.\n\nUse only 'domain_or_ip/filename.html'.":"URL ez da zuzena.\n\nErabili 'domeinu_edo_ip/fitxategia.html' bakarrik.","DNS client not present.":"DNS bezeroa ez dago.","Domain not in local DNS cache. Look up first.\n\nIf you already performed a lookup, the domain does not exist.":"Domeinua ez dago DNS cachean. Lehenik eta behin, bilatu.\n\nBilaketa jada eginda badago, domeinua ez dago.","Edit DHCP server info":"Editatu DHCP zerbitzariaren informazioa","HTTP Server":"HTTP Zerbitzaria",File:"Fitxategia",Back:"Atzera","HTTP Domain Files":"HTTP Domeinuaren Fitxategiak","HTTP Domain File Edition":"HTTP Domeinuaren Fitxategia Editatu","Input interface":"Sarrera Interfazea","WAN Port":"WAN Ataka","LAN Port":"LAN Ataka","IP: ":"IP: ","Gateway mode (uses NAT).":"Gateway modua (NAT erabiltzen du).","Edit NAT":"NAT editatu","Edit HTTP server info":"HTTP zerbitzariaren informazioa editatu",Delete:"Ezabatu",Edit:"Editatu",Add:"Gehitu","Sending traceroute to: ":"Traceroute bidaltzen honako helbide honetara: ","Sending ping to: ":"Ping bidaltzen honako helbide honetara: ","Ping response recieved from ":"Ping erantzuna honako helbide honetatik: "," - Traceroute to ":" - Traceroute honako helbide honetara: ","Network unreachable: ":"Sarea eskuraezina: ","Network not configured for interface: ":"Sarea ez dago konfiguratuta interfaze honetan: ","File name:":"Fitxategiaren izena:",Download:"Deskargatu","Download file":"Deskargatu fitxategia"};uitranslation.registerLocale(eu_ES);